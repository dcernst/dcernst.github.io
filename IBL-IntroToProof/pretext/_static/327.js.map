{"version":3,"file":"327.js","mappings":"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","sources":["webpack://WebComponents/./runestone/shortanswer/js/shortanswer.js","webpack://WebComponents/./runestone/shortanswer/js/timed_shortanswer.js","webpack://WebComponents/./runestone/timed/js/timed.js"],"sourcesContent":["/*==========================================\n=======    Master shortanswer.js    ========\n============================================\n===     This file contains the JS for    ===\n=== the Runestone shortanswer component. ===\n============================================\n===              Created by              ===\n===           Isaiah Mayerchak           ===\n===                7/2/15                ===\n===              Brad Miller             ===\n===                2019                  ===\n==========================================*/\n\nimport RunestoneBase from \"../../common/js/runestonebase.js\";\nimport \"./../css/shortanswer.css\";\n\nexport default class ShortAnswer extends RunestoneBase {\n    constructor(opts) {\n        super(opts);\n        if (opts) {\n            var orig = opts.orig; // entire <p> element that will be replaced by new HTML\n            this.useRunestoneServices =\n                opts.useRunestoneServices || eBookConfig.useRunestoneServices;\n            this.origElem = orig;\n            this.divid = orig.id;\n            this.question = this.origElem.innerHTML;\n            this.optional = false;\n            this.attachURL = opts.attachURL;\n            if ($(this.origElem).is(\"[data-optional]\")) {\n                this.optional = true;\n            }\n            if ($(this.origElem).is(\"[data-mathjax]\")) {\n                this.mathjax = true;\n            }\n            if ($(this.origElem).is(\"[data-attachment]\")) {\n                this.attachment = true;\n            }\n            this.placeholder =\n                $(this.origElem).data(\"placeholder\") ||\n                \"Write your answer here\";\n            this.renderHTML();\n            this.caption = \"shortanswer\";\n            this.addCaption(\"runestone\");\n            this.checkServer(\"shortanswer\", true);\n            if (typeof Prism !== \"undefined\") {\n                Prism.highlightAllUnder(this.containerDiv);\n            }\n        }\n    }\n\n    renderHTML() {\n        this.containerDiv = document.createElement(\"div\");\n        this.containerDiv.id = this.divid;\n        $(this.containerDiv).addClass(this.origElem.getAttribute(\"class\"));\n        this.newForm = document.createElement(\"form\");\n        this.newForm.id = this.divid + \"_journal\";\n        this.newForm.name = this.newForm.id;\n        this.newForm.action = \"\";\n        this.containerDiv.appendChild(this.newForm);\n        this.fieldSet = document.createElement(\"fieldset\");\n        this.newForm.appendChild(this.fieldSet);\n        this.firstLegendDiv = document.createElement(\"div\");\n        this.firstLegendDiv.innerHTML = this.question;\n        $(this.firstLegendDiv).addClass(\"journal-question\");\n        this.fieldSet.appendChild(this.firstLegendDiv);\n        this.jInputDiv = document.createElement(\"div\");\n        this.jInputDiv.id = this.divid + \"_journal_input\";\n        this.fieldSet.appendChild(this.jInputDiv);\n        this.jOptionsDiv = document.createElement(\"div\");\n        $(this.jOptionsDiv).addClass(\"journal-options\");\n        this.jInputDiv.appendChild(this.jOptionsDiv);\n        this.jLabel = document.createElement(\"label\");\n        $(this.jLabel).addClass(\"radio-inline\");\n        this.jOptionsDiv.appendChild(this.jLabel);\n        this.jTextArea = document.createElement(\"textarea\");\n        let self = this;\n        this.jTextArea.onchange = function () {\n            self.isAnswered = true;\n        };\n        this.jTextArea.id = this.divid + \"_solution\";\n        $(this.jTextArea).attr(\"aria-label\", \"textarea\");\n        this.jTextArea.placeholder = this.placeholder;\n        $(this.jTextArea).css(\"display:inline, width:530px\");\n        $(this.jTextArea).addClass(\"form-control\");\n        this.jTextArea.rows = 4;\n        this.jTextArea.cols = 50;\n        this.jLabel.appendChild(this.jTextArea);\n        this.jTextArea.onchange = function () {\n            this.isAnswered = true;\n            if (this.isTimed) {\n                this.feedbackDiv.innerHTML = \"Your answer is automatically saved.\";\n            } else {\n                this.feedbackDiv.innerHTML = \"Your answer has not been saved yet!\";\n            }\n            $(this.feedbackDiv).removeClass(\"alert-success\");\n            $(this.feedbackDiv).addClass(\"alert alert-danger\");\n        }.bind(this);\n        this.fieldSet.appendChild(document.createElement(\"br\"));\n        if (this.mathjax) {\n            this.renderedAnswer = document.createElement(\"div\");\n            $(this.renderedAnswer).addClass(\"latexoutput\");\n            this.fieldSet.appendChild(this.renderedAnswer);\n        }\n        this.buttonDiv = document.createElement(\"div\");\n        this.fieldSet.appendChild(this.buttonDiv);\n        this.submitButton = document.createElement(\"button\");\n        $(this.submitButton).addClass(\"btn btn-success\");\n        this.submitButton.type = \"button\";\n        this.submitButton.textContent = \"Save\";\n        this.submitButton.onclick = function () {\n            this.checkCurrentAnswer();\n            this.logCurrentAnswer();\n            this.renderFeedback();\n        }.bind(this);\n        this.buttonDiv.appendChild(this.submitButton);\n        this.randomSpan = document.createElement(\"span\");\n        this.randomSpan.innerHTML = \"Instructor's Feedback\";\n        this.fieldSet.appendChild(this.randomSpan);\n        this.otherOptionsDiv = document.createElement(\"div\");\n        $(this.otherOptionsDiv).css(\"padding-left:20px\");\n        $(this.otherOptionsDiv).addClass(\"journal-options\");\n        this.fieldSet.appendChild(this.otherOptionsDiv);\n        // add a feedback div to give user feedback\n        this.feedbackDiv = document.createElement(\"div\");\n        //$(this.feedbackDiv).addClass(\"bg-info form-control\");\n        //$(this.feedbackDiv).css(\"width:530px, background-color:#eee, font-style:italic\");\n        $(this.feedbackDiv).css(\"width:530px, font-style:italic\");\n        this.feedbackDiv.id = this.divid + \"_feedback\";\n        this.feedbackDiv.innerHTML = \"You have not answered this question yet.\";\n        $(this.feedbackDiv).addClass(\"alert alert-danger\");\n        //this.otherOptionsDiv.appendChild(this.feedbackDiv);\n        this.fieldSet.appendChild(this.feedbackDiv);\n        if (this.attachment) {\n            let attachDiv = document.createElement(\"div\")\n            if (this.graderactive) {\n                // If in grading mode make a button to create a popup with the image\n                let viewButton = document.createElement(\"button\")\n                viewButton.type = \"button\"\n                viewButton.innerHTML = \"View Attachment\"\n                viewButton.onclick = this.viewFile.bind(this);\n                attachDiv.appendChild(viewButton);\n            } else {\n                // Otherwise make a button for the student to select a file to upload.\n                this.fileUpload = document.createElement(\"input\")\n                this.fileUpload.type = \"file\";\n                this.fileUpload.id = `${this.divid}_fileme`;\n                attachDiv.appendChild(this.fileUpload);\n            }\n            this.containerDiv.appendChild(attachDiv);\n        }\n        //this.fieldSet.appendChild(document.createElement(\"br\"));\n        $(this.origElem).replaceWith(this.containerDiv);\n        // This is a stopgap measure for when MathJax is not loaded at all.  There is another\n        // more difficult case that when MathJax is loaded asynchronously we will get here\n        // before MathJax is loaded.  In that case we will need to implement something\n        // like `the solution described here <https://stackoverflow.com/questions/3014018/how-to-detect-when-mathjax-is-fully-loaded>`_\n        if (typeof MathJax !== \"undefined\") {\n            this.queueMathJax(this.containerDiv);\n        }\n    }\n\n    renderMath(value) {\n        if (this.mathjax) {\n            value = value.replace(/\\$\\$(.*?)\\$\\$/g, \"\\\\[ $1 \\\\]\");\n            value = value.replace(/\\$(.*?)\\$/g, \"\\\\( $1 \\\\)\");\n            $(this.renderedAnswer).text(value);\n            this.queueMathJax(this.renderedAnswer);\n        }\n    }\n\n    async checkCurrentAnswer() {\n        let value = $(document.getElementById(this.divid + \"_solution\")).val();\n        this.renderMath(value);\n        this.setLocalStorage({\n            answer: value,\n            timestamp: new Date(),\n        });\n    }\n\n    async logCurrentAnswer(sid) {\n        let value = $(document.getElementById(this.divid + \"_solution\")).val();\n        this.renderMath(value);\n        this.setLocalStorage({\n            answer: value,\n            timestamp: new Date(),\n        });\n        let data = {\n            event: \"shortanswer\",\n            act: value,\n            answer: value,\n            div_id: this.divid,\n        };\n        if (typeof sid !== \"undefined\") {\n            data.sid = sid;\n        }\n        await this.logBookEvent(data);\n        if (this.attachment) {\n            await this.uploadFile();\n        }\n    }\n\n    renderFeedback() {\n        this.feedbackDiv.innerHTML = \"Your answer has been saved.\";\n        $(this.feedbackDiv).removeClass(\"alert-danger\");\n        $(this.feedbackDiv).addClass(\"alert alert-success\");\n    }\n    setLocalStorage(data) {\n        if (!this.graderactive) {\n            let key = this.localStorageKey();\n            localStorage.setItem(key, JSON.stringify(data));\n        }\n    }\n    checkLocalStorage() {\n        // Repopulates the short answer text\n        // which was stored into local storage.\n        var answer = \"\";\n        if (this.graderactive) {\n            return;\n        }\n        var len = localStorage.length;\n        if (len > 0) {\n            var ex = localStorage.getItem(this.localStorageKey());\n            if (ex !== null) {\n                try {\n                    var storedData = JSON.parse(ex);\n                    answer = storedData.answer;\n                } catch (err) {\n                    // error while parsing; likely due to bad value stored in storage\n                    console.log(err.message);\n                    localStorage.removeItem(this.localStorageKey());\n                    return;\n                }\n                let solution = $(\"#\" + this.divid + \"_solution\");\n                solution.text(answer);\n                this.renderMath(answer);\n                this.feedbackDiv.innerHTML =\n                    \"Your current saved answer is shown above.\";\n                $(this.feedbackDiv).removeClass(\"alert-danger\");\n                $(this.feedbackDiv).addClass(\"alert alert-success\");\n            }\n        }\n    }\n    restoreAnswers(data) {\n        // Restore answers from storage retrieval done in RunestoneBase\n        // sometimes data.answer can be null\n        if (!data.answer) {\n            data.answer = \"\";\n        }\n        this.answer = data.answer;\n        this.jTextArea.value = this.answer;\n        this.renderMath(this.answer);\n\n        let p = document.createElement(\"p\");\n        this.jInputDiv.appendChild(p);\n        var tsString = \"\";\n        if (data.timestamp) {\n            tsString = new Date(data.timestamp).toLocaleString();\n        } else {\n            tsString = \"\";\n        }\n        $(p).text(tsString);\n        if (data.last_answer) {\n            this.current_answer = \"ontime\";\n            let toggle_answer_button = document.createElement(\"button\");\n            toggle_answer_button.type = \"button\";\n            $(toggle_answer_button).text(\"Show Late Answer\");\n            $(toggle_answer_button).addClass(\"btn btn-warning\");\n            $(toggle_answer_button).css(\"margin-left\", \"5px\");\n\n            $(toggle_answer_button).click(\n                function () {\n                    var display_timestamp, button_text;\n                    if (this.current_answer === \"ontime\") {\n                        this.jTextArea.value = data.last_answer;\n                        this.answer = data.last_answer;\n                        display_timestamp = new Date(\n                            data.last_timestamp\n                        ).toLocaleString();\n                        button_text = \"Show on-Time Answer\";\n                        this.current_answer = \"late\";\n                    } else {\n                        this.jTextArea.value = data.answer;\n                        this.answer = data.answer;\n                        display_timestamp = tsString;\n                        button_text = \"Show Late Answer\";\n                        this.current_answer = \"ontime\";\n                    }\n                    this.renderMath(this.answer);\n                    $(p).text(`Submitted: ${display_timestamp}`);\n                    $(toggle_answer_button).text(button_text);\n                }.bind(this)\n            );\n\n            this.buttonDiv.appendChild(toggle_answer_button);\n        }\n        let feedbackStr = \"Your current saved answer is shown above.\";\n        if (typeof data.score !== \"undefined\") {\n            feedbackStr = `Score: ${data.score}`;\n        }\n        if (data.comment) {\n            feedbackStr += ` -- ${data.comment}`;\n        }\n        this.feedbackDiv.innerHTML = feedbackStr;\n\n        $(this.feedbackDiv).removeClass(\"alert-danger\");\n        $(this.feedbackDiv).addClass(\"alert alert-success\");\n    }\n\n    disableInteraction() {\n        this.jTextArea.disabled = true;\n    }\n\n    async uploadFile() {\n        const files = this.fileUpload.files\n        const data = new FormData()\n        if (this.fileUpload.files.length > 0) {\n            data.append('file', files[0])\n            fetch(`/ns/logger/upload/${this.divid}`, {\n                method: 'POST',\n                body: data\n            })\n                .then(response => response.json())\n                .then(data => {\n                    console.log(data)\n                })\n                .catch(error => {\n                    console.error(error)\n                })\n        }\n    }\n\n    viewFile() {\n        // Get the URL from the S3 API -- saved when we display in grader mode\n        if (this.attachURL) {\n            //window.open(this.attachURL, \"_blank\");\n            const image_window = window.open(\"\", \"_blank\")\n            image_window.document.write(`\n                  <html>\n                    <head>\n                    </head>\n                    <body>\n                      <img src=\"${this.attachURL}\" alt=\"Attachment\" >\n                    </body>\n                  </html>\n            `);\n        } else {\n            alert(\"No attachment for this student.\")\n        }\n    }\n}\n\n/*=================================\n== Find the custom HTML tags and ==\n==   execute our code on them    ==\n=================================*/\n$(document).on(\"runestone:login-complete\", function () {\n    $(\"[data-component=shortanswer]\").each(function () {\n        if ($(this).closest(\"[data-component=timedAssessment]\").length == 0) {\n            // If this element exists within a timed component, don't render it here\n            try {\n                window.componentMap[this.id] = new ShortAnswer({\n                    orig: this,\n                    useRunestoneServices: eBookConfig.useRunestoneServices,\n                });\n            } catch (err) {\n                console.log(`Error rendering ShortAnswer Problem ${this.id}\n                Details: ${err}`);\n            }\n        }\n    });\n});\n","import ShortAnswer from \"./shortanswer.js\";\n\nexport default class TimedShortAnswer extends ShortAnswer {\n    constructor(opts) {\n        super(opts);\n        this.renderTimedIcon(this.containerDiv);\n        this.isTimed = true;\n        this.hideButtons();\n    }\n    hideButtons() {\n        $(this.submitButton).hide();\n    }\n    renderTimedIcon(component) {\n        // renders the clock icon on timed components.    The component parameter\n        // is the element that the icon should be appended to.\n        var timeIconDiv = document.createElement(\"div\");\n        var timeIcon = document.createElement(\"img\");\n        $(timeIcon).attr({\n            src: \"../_static/clock.png\",\n            style: \"width:15px;height:15px\",\n        });\n        timeIconDiv.className = \"timeTip\";\n        timeIconDiv.title = \"\";\n        timeIconDiv.appendChild(timeIcon);\n        $(component).prepend(timeIconDiv);\n    }\n    checkCorrectTimed() {\n        return \"I\"; // we ignore this in the grading\n    }\n    hideFeedback() {\n        $(this.feedbackDiv).hide();\n    }\n}\n\nif (typeof window.component_factory === \"undefined\") {\n    window.component_factory = {};\n}\n\nwindow.component_factory.shortanswer = function (opts) {\n    if (opts.timed) {\n        return new TimedShortAnswer(opts);\n    }\n    return new ShortAnswer(opts);\n};\n","/*==========================================\n========      Master timed.js     =========\n============================================\n===     This file contains the JS for    ===\n===     the Runestone timed component.   ===\n============================================\n===              Created By              ===\n===             Kirby Olson              ===\n===               6/11/15                ===\n==========================================*/\n\"use strict\";\n\nimport RunestoneBase from \"../../common/js/runestonebase.js\";\nimport TimedFITB from \"../../fitb/js/timedfitb.js\";\nimport TimedMC from \"../../mchoice/js/timedmc.js\";\nimport TimedShortAnswer from \"../../shortanswer/js/timed_shortanswer.js\";\nimport ACFactory from \"../../activecode/js/acfactory.js\";\nimport TimedClickableArea from \"../../clickableArea/js/timedclickable\";\nimport TimedDragNDrop from \"../../dragndrop/js/timeddnd.js\";\nimport TimedParsons from \"../../parsons/js/timedparsons.js\";\nimport SelectOne from \"../../selectquestion/js/selectone\";\nimport \"../css/timed.less\";\n\n// Timed constructor\nexport default class Timed extends RunestoneBase {\n    constructor(opts) {\n        super(opts);\n        var orig = opts.orig;\n        this.origElem = orig; // the entire element of this timed assessment and all of its children\n        this.divid = orig.id;\n        this.children = this.origElem.childNodes;\n        this.visited = [];\n        this.timeLimit = 0;\n        this.limitedTime = false;\n        if (!isNaN($(this.origElem).data(\"time\"))) {\n            this.timeLimit = parseInt($(this.origElem).data(\"time\"), 10) * 60; // time in seconds to complete the exam\n            this.startingTime = this.timeLimit;\n            this.limitedTime = true;\n        }\n        this.showFeedback = true;\n        if ($(this.origElem).is(\"[data-no-feedback]\")) {\n            this.showFeedback = false;\n        }\n        this.showResults = false;\n        if ($(this.origElem).is(\"[data-result]\")) {\n            this.showResults = false;\n        }\n        this.random = false;\n        if ($(this.origElem).is(\"[data-random]\")) {\n            this.random = true;\n        }\n        this.showTimer = true;\n        if ($(this.origElem).is(\"[data-no-timer]\")) {\n            this.showTimer = false;\n        }\n        this.fullwidth = false;\n        if ($(this.origElem).is(\"[data-fullwidth]\")) {\n            this.fullwidth = true;\n        }\n        this.nopause = false;\n        if ($(this.origElem).is(\"[data-no-pause]\")) {\n            this.nopause = true;\n        }\n        eBookConfig.enableScratchAC = false;\n        this.running = 0;\n        this.paused = 0;\n        this.done = 0;\n        this.taken = 0;\n        this.score = 0;\n        this.incorrect = 0;\n        this.correctStr = \"\";\n        this.incorrectStr = \"\";\n        this.skippedStr = \"\";\n        this.skipped = 0;\n        this.currentQuestionIndex = 0; // Which question is currently displaying on the page\n        this.renderedQuestionArray = []; // list of all problems\n        this.getNewChildren();\n        // One small step to eliminate students from doing view source\n        // this won't stop anyone with determination but may prevent casual peeking\n        if (!eBookConfig.enableDebug) {\n            document.body.oncontextmenu = function () {\n                return false;\n            };\n        }\n        this.checkAssessmentStatus().then(\n            function () {\n                this.renderTimedAssess();\n            }.bind(this)\n        );\n    }\n\n    getNewChildren() {\n        this.newChildren = [];\n        let runestoneChildren = this.origElem.querySelectorAll(\".runestone\");\n        for (var i = 0; i < runestoneChildren.length; i++) {\n            this.newChildren.push(runestoneChildren[i]);\n        }\n    }\n\n    async checkAssessmentStatus() {\n        // Has the user taken this exam?  Inquiring minds want to know\n        // If a user has not taken this exam then we want to make sure\n        // that if a question has been seen by the student before we do\n        // not populate previous answers.\n        let sendInfo = {\n            div_id: this.divid,\n            course_name: eBookConfig.course,\n        };\n        console.log(sendInfo);\n        if (eBookConfig.useRunestoneServices) {\n            let request = new Request(\n                `${eBookConfig.new_server_prefix}/assessment/tookTimedAssessment`,\n                {\n                    method: \"POST\",\n                    headers: this.jsonHeaders,\n                    body: JSON.stringify(sendInfo),\n                }\n            );\n            let response = await fetch(request);\n            let data = await response.json();\n            data = data.detail;\n            this.taken = data.tookAssessment;\n            this.assessmentTaken = this.taken;\n            if (!this.taken) {\n                localStorage.clear();\n            }\n            console.log(\"done with check status\");\n            return response;\n        } else {\n            this.taken = false;\n            this.assessmentTaken = false;\n            return Promise.resolve();\n        }\n    }\n\n    /*===============================\n    === Generating new Timed HTML ===\n    ===============================*/\n    async renderTimedAssess() {\n        console.log(\"rendering timed \");\n        // create renderedQuestionArray returns a promise\n        //\n        this.createRenderedQuestionArray();\n        if (this.random) {\n            this.randomizeRQA();\n        }\n        this.renderContainer();\n        this.renderTimer();\n        await this.renderControlButtons();\n        this.containerDiv.appendChild(this.timedDiv); // This can't be appended in renderContainer because then it renders above the timer and control buttons.\n        if (this.renderedQuestionArray.length > 1) this.renderNavControls();\n        this.renderSubmitButton();\n        this.renderFeedbackContainer();\n        this.useRunestoneServices = eBookConfig.useRunestoneServices;\n        // Replace intermediate HTML with rendered HTML\n        $(this.origElem).replaceWith(this.containerDiv);\n        // check if already taken and if so show results\n        this.styleExamElements(); // rename to renderPossibleResults\n        this.checkServer(\"timedExam\", true);\n    }\n\n    renderContainer() {\n        this.containerDiv = document.createElement(\"div\"); // container for the entire Timed Component\n        if (this.fullwidth) {\n            // allow the container to fill the width - barb\n            $(this.containerDiv).attr({\n                style: \"max-width:none\",\n            });\n        }\n        this.containerDiv.classList.add(\"runestone-sphinx\");\n        this.containerDiv.id = this.divid;\n        this.timedDiv = document.createElement(\"div\"); // div that will hold the questions for the timed assessment\n        this.navDiv = document.createElement(\"div\"); // For navigation control\n        $(this.navDiv).attr({\n            style: \"text-align:center\",\n        });\n        this.flagDiv = document.createElement(\"div\"); // div that will hold the \"Flag Question\" button\n        $(this.flagDiv).attr({\n            style: \"text-align: center\",\n        });\n        this.switchContainer = document.createElement(\"div\");\n        this.switchContainer.classList.add(\"switchcontainer\");\n        this.switchDiv = document.createElement(\"div\"); // is replaced by the questions\n        this.timedDiv.appendChild(this.navDiv);\n        this.timedDiv.appendChild(this.flagDiv); // add flagDiv to timedDiv, which holds components for navigation and questions for timed assessment\n        this.timedDiv.appendChild(this.switchContainer);\n        this.switchContainer.appendChild(this.switchDiv);\n        $(this.timedDiv).attr({\n            id: \"timed_Test\",\n            style: \"display:none\",\n        });\n    }\n\n    renderTimer() {\n        this.wrapperDiv = document.createElement(\"div\");\n        this.timerContainer = document.createElement(\"P\");\n        this.wrapperDiv.id = this.divid + \"-startWrapper\";\n        this.timerContainer.id = this.divid + \"-output\";\n        this.wrapperDiv.appendChild(this.timerContainer);\n        this.showTime();\n    }\n\n    renderControlButtons() {\n        this.controlDiv = document.createElement(\"div\");\n        $(this.controlDiv).attr({\n            id: \"controls\",\n            style: \"text-align: center\",\n        });\n        this.startBtn = document.createElement(\"button\");\n        this.pauseBtn = document.createElement(\"button\");\n        $(this.startBtn).attr({\n            class: \"btn btn-success\",\n            id: \"start\",\n            tabindex: \"0\",\n            role: \"button\",\n        });\n        this.startBtn.textContent = \"Start\";\n        this.startBtn.addEventListener(\n            \"click\",\n            async function () {\n                $(this.finishButton).hide(); // hide the finish button for now\n                $(this.flagButton).show();\n                let mess = document.createElement(\"p\");\n                mess.innerHTML =\n                    \"<strong>Warning: You will not be able to continue the exam if you close this tab, close the window, or navigate away from this page!</strong>  Make sure you click the Finish Exam button when you are done to submit your work!\";\n                this.controlDiv.appendChild(mess);\n                mess.classList.add(\"examwarning\");\n                await this.renderTimedQuestion();\n                this.startAssessment();\n            }.bind(this),\n            false\n        );\n        $(this.pauseBtn).attr({\n            class: \"btn btn-default\",\n            id: \"pause\",\n            disabled: \"true\",\n            tabindex: \"0\",\n            role: \"button\",\n        });\n        this.pauseBtn.textContent = \"Pause\";\n        this.pauseBtn.addEventListener(\n            \"click\",\n            function () {\n                this.pauseAssessment();\n            }.bind(this),\n            false\n        );\n        if (!this.taken) {\n            this.controlDiv.appendChild(this.startBtn);\n        }\n        if (!this.nopause) {\n            this.controlDiv.appendChild(this.pauseBtn);\n        }\n        this.containerDiv.appendChild(this.wrapperDiv);\n        this.containerDiv.appendChild(this.controlDiv);\n    }\n\n    renderNavControls() {\n        // making \"Prev\" button\n        this.pagNavList = document.createElement(\"ul\");\n        $(this.pagNavList).addClass(\"pagination\");\n        this.leftContainer = document.createElement(\"li\");\n        this.leftNavButton = document.createElement(\"button\");\n        this.leftNavButton.innerHTML = \"&#8249; Prev\";\n        $(this.leftNavButton).attr(\"aria-label\", \"Previous\");\n        $(this.leftNavButton).attr(\"tabindex\", \"0\");\n        $(this.leftNavButton).attr(\"role\", \"button\");\n        $(this.rightNavButton).attr(\"id\", \"prev\");\n        $(this.leftNavButton).css(\"cursor\", \"pointer\");\n        this.leftContainer.appendChild(this.leftNavButton);\n        this.pagNavList.appendChild(this.leftContainer);\n        // making \"Flag Question\" button\n        this.flaggingPlace = document.createElement(\"ul\");\n        $(this.flaggingPlace).addClass(\"pagination\");\n        this.flagContainer = document.createElement(\"li\");\n        this.flagButton = document.createElement(\"button\");\n        $(this.flagButton).addClass(\"flagBtn\");\n        this.flagButton.innerHTML = \"Flag Question\"; // name on button\n        $(this.flagButton).attr(\"aria-labelledby\", \"Flag\");\n        $(this.flagButton).attr(\"tabindex\", \"5\");\n        $(this.flagButton).attr(\"role\", \"button\");\n        $(this.flagButton).attr(\"id\", \"flag\");\n        $(this.flagButton).css(\"cursor\", \"pointer\");\n        this.flagContainer.appendChild(this.flagButton); // adding button to container\n        this.flaggingPlace.appendChild(this.flagContainer); // adding container to flaggingPlace\n        // making \"Next\" button\n        this.rightContainer = document.createElement(\"li\");\n        this.rightNavButton = document.createElement(\"button\");\n        $(this.rightNavButton).attr(\"aria-label\", \"Next\");\n        $(this.rightNavButton).attr(\"tabindex\", \"0\");\n        $(this.rightNavButton).attr(\"role\", \"button\");\n        $(this.rightNavButton).attr(\"id\", \"next\");\n        this.rightNavButton.innerHTML = \"Next &#8250;\";\n        $(this.rightNavButton).css(\"cursor\", \"pointer\");\n        this.rightContainer.appendChild(this.rightNavButton);\n        this.pagNavList.appendChild(this.rightContainer);\n        this.ensureButtonSafety();\n        this.navDiv.appendChild(this.pagNavList);\n        this.flagDiv.appendChild(this.flaggingPlace); // adds flaggingPlace to the flagDiv\n        this.break = document.createElement(\"br\");\n        this.navDiv.appendChild(this.break);\n        // render the question number jump buttons\n        this.qNumList = document.createElement(\"ul\");\n        $(this.qNumList).attr(\"id\", \"pageNums\");\n        this.qNumWrapperList = document.createElement(\"ul\");\n        $(this.qNumWrapperList).addClass(\"pagination\");\n        var tmpLi, tmpA;\n        for (var i = 0; i < this.renderedQuestionArray.length; i++) {\n            tmpLi = document.createElement(\"li\");\n            tmpA = document.createElement(\"a\");\n            tmpA.innerHTML = i + 1;\n            $(tmpA).css(\"cursor\", \"pointer\");\n            if (i === 0) {\n                $(tmpLi).addClass(\"active\");\n            }\n            tmpLi.appendChild(tmpA);\n            this.qNumWrapperList.appendChild(tmpLi);\n        }\n        this.qNumList.appendChild(this.qNumWrapperList);\n        this.navDiv.appendChild(this.qNumList);\n        this.navBtnListeners();\n        this.flagBtnListener(); // listens for click on flag button\n        $(this.flagButton).hide();\n    }\n\n    // when moving off of a question in an active exam:\n    // 1. show that the question has been seen, or mark it broken if it is in error.\n    // 2. check and log the current answer\n    async navigateAway() {\n        if (\n            this.renderedQuestionArray[this.currentQuestionIndex].state ==\n            \"broken_exam\"\n        ) {\n            $(\n                \"ul#pageNums > ul > li:eq(\" + this.currentQuestionIndex + \")\"\n            ).addClass(\"broken\");\n        }\n        if (\n            this.renderedQuestionArray[this.currentQuestionIndex].state ==\n            \"exam_ended\"\n        ) {\n            $(\n                \"ul#pageNums > ul > li:eq(\" + this.currentQuestionIndex + \")\"\n            ).addClass(\"toolate\");\n        }\n        if (\n            this.renderedQuestionArray[this.currentQuestionIndex].question\n                .isAnswered\n        ) {\n            $(\n                \"ul#pageNums > ul > li:eq(\" + this.currentQuestionIndex + \")\"\n            ).addClass(\"answered\");\n            await this.renderedQuestionArray[\n                this.currentQuestionIndex\n            ].question.checkCurrentAnswer();\n            if (!this.done) {\n                await this.renderedQuestionArray[\n                    this.currentQuestionIndex\n                ].question.logCurrentAnswer();\n            }\n        }\n    }\n    async handleNextPrev(event) {\n        if (!this.taken) {\n            await this.navigateAway();\n        }\n        var target = $(event.target).text();\n        if (target.match(/Next/)) {\n            // checks given text to match \"Next\"\n            if ($(this.rightContainer).hasClass(\"disabled\")) {\n                return;\n            }\n            this.currentQuestionIndex++;\n        } else if (target.match(/Prev/)) {\n            // checks given text to match \"Prev\"\n            if ($(this.leftContainer).hasClass(\"disabled\")) {\n                return;\n            }\n            this.currentQuestionIndex--;\n        }\n        await this.renderTimedQuestion();\n        this.ensureButtonSafety();\n        for (var i = 0; i < this.qNumList.childNodes.length; i++) {\n            for (\n                var j = 0;\n                j < this.qNumList.childNodes[i].childNodes.length;\n                j++\n            ) {\n                $(this.qNumList.childNodes[i].childNodes[j]).removeClass(\n                    \"active\"\n                );\n            }\n        }\n        $(\n            \"ul#pageNums > ul > li:eq(\" + this.currentQuestionIndex + \")\"\n        ).addClass(\"active\");\n        if (\n            $(\n                \"ul#pageNums > ul > li:eq(\" + this.currentQuestionIndex + \")\"\n            ).hasClass(\"flagcolor\")\n        ) {\n            // checking for class\n            this.flagButton.innerHTML = \"Unflag Question\"; // changes text on button\n        } else {\n            this.flagButton.innerHTML = \"Flag Question\"; // changes text on button\n        }\n    }\n\n    async handleFlag(event) {\n        // called when flag button is clicked\n        var target = $(event.target).text();\n        if (target.match(/Flag Question/)) {\n            $(\n                \"ul#pageNums > ul > li:eq(\" + this.currentQuestionIndex + \")\"\n            ).addClass(\"flagcolor\"); // class will change color of question block\n            this.flagButton.innerHTML = \"Unflag Question\";\n        } else {\n            $(\n                \"ul#pageNums > ul > li:eq(\" + this.currentQuestionIndex + \")\"\n            ).removeClass(\"flagcolor\"); // will restore current color of question block\n            this.flagButton.innerHTML = \"Flag Question\"; // also sets name back\n        }\n    }\n\n    async handleNumberedNav(event) {\n        if (!this.taken) {\n            await this.navigateAway();\n        }\n        for (var i = 0; i < this.qNumList.childNodes.length; i++) {\n            for (\n                var j = 0;\n                j < this.qNumList.childNodes[i].childNodes.length;\n                j++\n            ) {\n                $(this.qNumList.childNodes[i].childNodes[j]).removeClass(\n                    \"active\"\n                );\n            }\n        }\n\n        var target = $(event.target).text();\n        let oldIndex = this.currentQuestionIndex;\n        this.currentQuestionIndex = parseInt(target) - 1;\n        if (this.currentQuestionIndex > this.renderedQuestionArray.length) {\n            console.log(`Error: bad index for ${target}`);\n            this.currentQuestionIndex = oldIndex;\n        }\n        $(\n            \"ul#pageNums > ul > li:eq(\" + this.currentQuestionIndex + \")\"\n        ).addClass(\"active\");\n        if (\n            $(\n                \"ul#pageNums > ul > li:eq(\" + this.currentQuestionIndex + \")\" // checking for flagcolor class\n            ).hasClass(\"flagcolor\")\n        ) {\n            this.flagButton.innerHTML = \"Unflag Question\";\n        } else {\n            this.flagButton.innerHTML = \"Flag Question\";\n        }\n        await this.renderTimedQuestion();\n        this.ensureButtonSafety();\n    }\n\n    // set up events for navigation\n    navBtnListeners() {\n        // Next and Prev Listener\n        this.pagNavList.addEventListener(\n            \"click\",\n            this.handleNextPrev.bind(this),\n            false\n        );\n\n        // Numbered Listener\n        this.qNumList.addEventListener(\n            \"click\",\n            this.handleNumberedNav.bind(this),\n            false\n        );\n    }\n\n    // set up event for flag\n    flagBtnListener() {\n        this.flaggingPlace.addEventListener(\n            \"click\",\n            this.handleFlag.bind(this), // calls this to take action\n            false\n        );\n    }\n\n    renderSubmitButton() {\n        this.buttonContainer = document.createElement(\"div\");\n        $(this.buttonContainer).attr({\n            style: \"text-align:center\",\n        });\n        this.finishButton = document.createElement(\"button\");\n        $(this.finishButton).attr({\n            id: \"finish\",\n            class: \"btn btn-primary\",\n        });\n        this.finishButton.textContent = \"Finish Exam\";\n        this.finishButton.addEventListener(\n            \"click\",\n            async function () {\n                let skipped =\n                    this.renderedQuestionArray.filter((x) => !x.question.isAnswered).length;\n                let skipstr = skipped > 0 ? `You have skipped ${skipped} question(s).` : \"\";\n                if (\n                    window.confirm(\n                        `${skipstr} Clicking OK means you are ready to submit your answers and are finished with this assessment.`\n                    )\n                ) {\n                    await this.finishAssessment();\n                    $(this.flagButton).hide();\n                }\n            }.bind(this),\n            false\n        );\n        this.controlDiv.appendChild(this.finishButton);\n        $(this.finishButton).hide();\n        this.timedDiv.appendChild(this.buttonContainer);\n    }\n    ensureButtonSafety() {\n        if (this.currentQuestionIndex === 0) {\n            if (this.renderedQuestionArray.length != 1) {\n                $(this.rightContainer).removeClass(\"disabled\");\n            }\n            $(this.leftContainer).addClass(\"disabled\");\n        }\n        if (\n            this.currentQuestionIndex >=\n            this.renderedQuestionArray.length - 1\n        ) {\n            if (this.renderedQuestionArray.length != 1) {\n                $(this.leftContainer).removeClass(\"disabled\");\n            }\n            $(this.rightContainer).addClass(\"disabled\");\n        }\n        if (\n            this.currentQuestionIndex > 0 &&\n            this.currentQuestionIndex < this.renderedQuestionArray.length - 1\n        ) {\n            $(this.rightContainer).removeClass(\"disabled\");\n            $(this.leftContainer).removeClass(\"disabled\");\n        }\n    }\n    renderFeedbackContainer() {\n        this.scoreDiv = document.createElement(\"P\");\n        if (this.taken) {\n            this.scoreDiv.innerHTML = \"<h2>You have already taken this exam</h2>\";\n            this.scoreDiv.style.display = \"block\";\n        } else {\n            this.scoreDiv.id = this.divid + \"results\";\n            this.scoreDiv.style.display = \"none\";\n        }\n        this.containerDiv.appendChild(this.scoreDiv);\n    }\n\n    createRenderedQuestionArray() {\n        // this finds all the assess questions in this timed assessment\n        // We need to make a list of all the questions up front so we can set up navigation\n        // but we do not want to render the questions until the student has navigated\n        // Also adds them to this.renderedQuestionArray\n\n        // todo:  This needs to be updated to account for the runestone div wrapper.\n\n        // To accommodate the selectquestion type -- which is async! we need to wrap\n        // all of this in a promise, so that we don't continue to render the timed\n        // exam until all of the questions have been realized.\n        var opts;\n        for (var i = 0; i < this.newChildren.length; i++) {\n            var tmpChild = this.newChildren[i];\n            opts = {\n                state: \"prepared\",\n                orig: tmpChild,\n                question: {},\n                useRunestoneServices: eBookConfig.useRunestoneServices,\n                timed: true,\n                assessmentTaken: this.taken,\n                timedWrapper: this.divid,\n                initAttempts: 0,\n            };\n            if ($(tmpChild).children(\"[data-component]\").length > 0) {\n                tmpChild = $(tmpChild).children(\"[data-component]\")[0];\n                opts.orig = tmpChild;\n            }\n            if ($(tmpChild).is(\"[data-component]\")) {\n                this.renderedQuestionArray.push(opts);\n            }\n        }\n    }\n\n    randomizeRQA() {\n        var currentIndex = this.renderedQuestionArray.length,\n            temporaryValue,\n            randomIndex;\n        // While there remain elements to shuffle...\n        while (currentIndex !== 0) {\n            // Pick a remaining element...\n            randomIndex = Math.floor(Math.random() * currentIndex);\n            currentIndex -= 1;\n            // And swap it with the current element.\n            temporaryValue = this.renderedQuestionArray[currentIndex];\n            this.renderedQuestionArray[currentIndex] =\n                this.renderedQuestionArray[randomIndex];\n            this.renderedQuestionArray[randomIndex] = temporaryValue;\n        }\n    }\n\n    async renderTimedQuestion() {\n        if (this.currentQuestionIndex >= this.renderedQuestionArray.length) {\n            // sometimes the user clicks in the event area for the qNumList\n            // But misses a number in that case the text is the concatenation\n            // of all the numbers in the list!\n            return;\n        }\n        // check the renderedQuestionArray to see if it has been rendered.\n        let opts = this.renderedQuestionArray[this.currentQuestionIndex];\n        let currentQuestion;\n        if (\n            opts.state === \"prepared\" ||\n            opts.state === \"forreview\" ||\n            (opts.state === \"broken_exam\" && opts.initAttempts < 3)\n        ) {\n            let tmpChild = opts.orig;\n            if ($(tmpChild).is(\"[data-component=selectquestion]\")) {\n                if (this.done && opts.state == \"prepared\") {\n                    this.renderedQuestionArray[\n                        this.currentQuestionIndex\n                    ].state = \"exam_ended\";\n                } else {\n                    // SelectOne is async and will replace itself in this array with\n                    // the actual selected question\n                    opts.rqa = this.renderedQuestionArray;\n                    let newq = new SelectOne(opts);\n                    this.renderedQuestionArray[this.currentQuestionIndex] = {\n                        question: newq,\n                    };\n                    try {\n                        await newq.initialize();\n                        if (opts.state == \"broken_exam\") {\n                            // remove the broken class from this question if we get here.\n                            $(\n                                `ul#pageNums > ul > li:eq(${this.currentQuestionIndex})`\n                            ).removeClass(\"broken\");\n                        }\n                    } catch (e) {\n                        opts.state = \"broken_exam\";\n                        this.renderedQuestionArray[this.currentQuestionIndex] =\n                            opts;\n                        console.log(\n                            `Error initializing question: Details ${e}`\n                        );\n                    }\n                }\n            } else if ($(tmpChild).is(\"[data-component]\")) {\n                let componentKind = $(tmpChild).data(\"component\");\n                this.renderedQuestionArray[this.currentQuestionIndex] = {\n                    question: window.component_factory[componentKind](opts),\n                    state: opts.state,\n                };\n            }\n        } else if (opts.state === \"broken_exam\") {\n            return;\n        }\n\n        currentQuestion =\n            this.renderedQuestionArray[this.currentQuestionIndex].question;\n        if (opts.state === \"forreview\") {\n            await currentQuestion.component_ready_promise;\n            await currentQuestion.checkCurrentAnswer();\n            currentQuestion.renderFeedback();\n            currentQuestion.disableInteraction();\n        }\n\n        if (!this.visited.includes(this.currentQuestionIndex)) {\n            this.visited.push(this.currentQuestionIndex);\n            if (\n                this.visited.length === this.renderedQuestionArray.length &&\n                !this.done\n            ) {\n                $(this.finishButton).show();\n            }\n        }\n\n        if (currentQuestion.containerDiv) {\n            if (\n                currentQuestion.containerDiv.classList.contains(\"runestone\") ==\n                false\n            ) {\n                currentQuestion.containerDiv.classList.add(\"runestone\");\n            }\n            $(this.switchDiv).replaceWith(currentQuestion.containerDiv);\n            this.switchDiv = currentQuestion.containerDiv;\n        }\n\n        // If the timed component has listeners, those might need to be reinitialized\n        // This flag will only be set in the elements that need it--it will be undefined in the others and thus evaluate to false\n        if (currentQuestion.needsReinitialization) {\n            currentQuestion.reinitializeListeners(this.taken);\n        }\n    }\n\n    /*=================================\n    === Timer and control Functions ===\n    =================================*/\n    handlePrevAssessment() {\n        $(this.startBtn).hide();\n        $(this.pauseBtn).attr(\"disabled\", true);\n        $(this.finishButton).attr(\"disabled\", true);\n        this.running = 0;\n        this.done = 1;\n        // showFeedback sand showResults should both be true before we show the\n        // questions and their state of correctness.\n        if (this.showResults && this.showFeedback) {\n            $(this.timedDiv).show();\n            this.restoreAnsweredQuestions(); // do not log these results\n        } else {\n            $(this.pauseBtn).hide();\n            $(this.timerContainer).hide();\n        }\n    }\n    startAssessment() {\n        if (!this.taken) {\n            $(\"#relations-next\").hide(); // hide the next page button for now\n            $(\"#relations-prev\").hide(); // hide the previous button for now\n            $(this.startBtn).hide();\n            $(this.pauseBtn).attr(\"disabled\", false);\n            if (this.running === 0 && this.paused === 0) {\n                this.running = 1;\n                this.lastTime = Date.now();\n                $(this.timedDiv).show();\n                this.increment();\n                this.logBookEvent({\n                    event: \"timedExam\",\n                    act: \"start\",\n                    div_id: this.divid,\n                });\n                var timeStamp = new Date();\n                var storageObj = {\n                    answer: [0, 0, this.renderedQuestionArray.length, 0],\n                    timestamp: timeStamp,\n                };\n                localStorage.setItem(\n                    this.localStorageKey(),\n                    JSON.stringify(storageObj)\n                );\n            }\n            $(window).on(\n                \"beforeunload\",\n                function (event) {\n                    // this actual value gets ignored by newer browsers\n                    if (this.done) {\n                        return;\n                    }\n                    event.preventDefault();\n                    event.returnValue =\n                        \"Are you sure you want to leave?  Your work will be lost! And you will need your instructor to reset the exam!\";\n                    return \"Are you sure you want to leave?  Your work will be lost!\";\n                }.bind(this)\n            );\n            window.addEventListener(\n                \"pagehide\",\n                async function (event) {\n                    if (!this.done) {\n                        await this.finishAssessment();\n                        console.log(\"Exam exited by leaving page\");\n                    }\n                }.bind(this)\n            );\n        } else {\n            this.handlePrevAssessment();\n        }\n    }\n    pauseAssessment() {\n        if (this.done === 0) {\n            if (this.running === 1) {\n                this.logBookEvent({\n                    event: \"timedExam\",\n                    act: \"pause\",\n                    div_id: this.divid,\n                });\n                this.running = 0;\n                this.paused = 1;\n                this.pauseBtn.innerHTML = \"Resume\";\n                $(this.timedDiv).hide();\n            } else {\n                this.logBookEvent({\n                    event: \"timedExam\",\n                    act: \"resume\",\n                    div_id: this.divid,\n                });\n                this.running = 1;\n                this.paused = 0;\n                this.increment();\n                this.pauseBtn.innerHTML = \"Pause\";\n                $(this.timedDiv).show();\n            }\n        }\n    }\n\n    showTime() {\n        if (this.showTimer) {\n            var mins = Math.floor(this.timeLimit / 60);\n            var secs = Math.floor(this.timeLimit) % 60;\n            var minsString = mins;\n            var secsString = secs;\n            if (mins < 10) {\n                minsString = \"0\" + mins;\n            }\n            if (secs < 10) {\n                secsString = \"0\" + secs;\n            }\n            var beginning = \"Time Remaining    \";\n            if (!this.limitedTime) {\n                beginning = \"Time Taken    \";\n            }\n            var timeString = beginning + minsString + \":\" + secsString;\n            if (this.done || this.taken) {\n                var minutes = Math.floor(this.timeTaken / 60);\n                var seconds = Math.floor(this.timeTaken % 60);\n                if (minutes < 10) {\n                    minutes = \"0\" + minutes;\n                }\n                if (seconds < 10) {\n                    seconds = \"0\" + seconds;\n                }\n                timeString = \"Time taken: \" + minutes + \":\" + seconds;\n            }\n            this.timerContainer.innerHTML = timeString;\n            var timeTips = document.getElementsByClassName(\"timeTip\");\n            for (var i = 0; i <= timeTips.length - 1; i++) {\n                timeTips[i].title = timeString;\n            }\n        } else {\n            $(this.timerContainer).hide();\n        }\n    }\n\n    increment() {\n        // if running (not paused) and not taken\n        if (this.running === 1 && !this.taken) {\n            setTimeout(\n                function () {\n                    // When a browser loses focus, setTimeout may not be called on the\n                    // schedule expected.  Browsers are free to save power by lengthening\n                    // the interval to some longer time.  So we cannot just subtract 1\n                    // from the timeLimit we need to measure the elapsed time from the last\n                    // call to the current call and subtract that number of seconds.\n                    let currentTime = Date.now();\n                    if (this.limitedTime) {\n                        // If there's a time limit, count down to 0\n                        this.timeLimit =\n                            this.timeLimit -\n                            Math.floor((currentTime - this.lastTime) / 1000);\n                    } else {\n                        // Else count up to keep track of how long it took to complete\n                        this.timeLimit =\n                            this.timeLimit +\n                            Math.floor((currentTime - this.lastTime) / 1000);\n                    }\n                    this.lastTime = currentTime;\n                    localStorage.setItem(\n                        eBookConfig.email + \":\" + this.divid + \"-time\",\n                        this.timeLimit\n                    );\n                    this.showTime();\n                    if (this.timeLimit > 0) {\n                        this.increment();\n                        // ran out of time\n                    } else {\n                        $(this.startBtn).attr({\n                            disabled: \"true\",\n                        });\n                        $(this.finishButton).attr({\n                            disabled: \"true\",\n                        });\n                        this.running = 0;\n                        this.done = 1;\n                        if (!this.taken) {\n                            this.taken = true;\n                            // embed the message in the page -- an alert actually prevents\n                            // the answers from being submitted and if a student closes their\n                            // laptop then the answers will not be submitted ever!  Even when they\n                            // reopen the laptop their session cookie is likely invalid.\n                            let mess = document.createElement(\"h1\");\n                            mess.innerHTML =\n                                \"Sorry but you ran out of time. Your answers are being submitted\";\n                            this.controlDiv.appendChild(mess);\n                            this.finishAssessment();\n                        }\n                    }\n                }.bind(this),\n                1000\n            );\n        }\n    }\n\n    styleExamElements() {\n        // Checks if this exam has been taken before\n        $(this.timerContainer).css({\n            width: \"50%\",\n            margin: \"0 auto\",\n            \"background-color\": \"#DFF0D8\",\n            \"text-align\": \"center\",\n            border: \"2px solid #DFF0D8\",\n            \"border-radius\": \"25px\",\n        });\n        $(this.scoreDiv).css({\n            width: \"50%\",\n            margin: \"0 auto\",\n            \"background-color\": \"#DFF0D8\",\n            \"text-align\": \"center\",\n            border: \"2px solid #DFF0D8\",\n            \"border-radius\": \"25px\",\n        });\n        $(\".tooltipTime\").css({\n            margin: \"0\",\n            padding: \"0\",\n            \"background-color\": \"black\",\n            color: \"white\",\n        });\n    }\n\n    async finishAssessment() {\n        $(\"#relations-next\").show(); // show the next page button for now\n        $(\"#relations-prev\").show(); // show the previous button for now\n        if (!this.showFeedback) {\n            // bje - changed from showResults\n            $(this.timedDiv).hide();\n            $(this.pauseBtn).hide();\n            $(this.timerContainer).hide();\n        }\n        this.findTimeTaken();\n        this.running = 0;\n        this.done = 1;\n        this.taken = 1;\n        await this.finalizeProblems();\n        this.checkScore();\n        this.displayScore();\n        this.storeScore();\n        this.logScore();\n        $(this.pauseBtn).attr(\"disabled\", true);\n        this.finishButton.disabled = true;\n        $(window).off(\"beforeunload\");\n        // turn off the pagehide listener\n        let assignment_id = this.divid;\n        setTimeout(function () {\n            jQuery.ajax({\n                url: eBookConfig.app + \"/assignments/student_autograde\",\n                type: \"POST\",\n                dataType: \"JSON\",\n                data: {\n                    assignment_id: assignment_id,\n                    is_timed: true,\n                },\n                success: function (retdata) {\n                    if (retdata.success == false) {\n                        console.log(retdata.message);\n                    } else {\n                        console.log(\"Autograder completed\");\n                    }\n                },\n            });\n        }, 2000);\n    }\n\n    // finalizeProblems\n    // ----------------\n    async finalizeProblems() {\n        // Because we have submitted each question as we navigate we only need to\n        // send the final version of the question the student is on when they press the\n        // finish exam button.\n\n        var currentQuestion =\n            this.renderedQuestionArray[this.currentQuestionIndex].question;\n        await currentQuestion.checkCurrentAnswer();\n        await currentQuestion.logCurrentAnswer();\n        currentQuestion.renderFeedback();\n        currentQuestion.disableInteraction();\n\n        for (var i = 0; i < this.renderedQuestionArray.length; i++) {\n            let currentQuestion = this.renderedQuestionArray[i];\n            // set the state to forreview so we know that feedback may be appropriate\n            if (currentQuestion.state !== \"broken_exam\") {\n                currentQuestion.state = \"forreview\";\n                currentQuestion.question.disableInteraction();\n            }\n        }\n\n        if (!this.showFeedback) {\n            this.hideTimedFeedback();\n        }\n    }\n\n    // restoreAnsweredQuestions\n    // ------------------------\n    restoreAnsweredQuestions() {\n        for (var i = 0; i < this.renderedQuestionArray.length; i++) {\n            var currentQuestion = this.renderedQuestionArray[i];\n            if (currentQuestion.state === \"prepared\") {\n                currentQuestion.state = \"forreview\";\n            }\n        }\n    }\n\n    // hideTimedFeedback\n    // -----------------\n    hideTimedFeedback() {\n        for (var i = 0; i < this.renderedQuestionArray.length; i++) {\n            var currentQuestion = this.renderedQuestionArray[i].question;\n            currentQuestion.hideFeedback();\n        }\n    }\n\n    // checkScore\n    // ----------\n    // This is a simple all or nothing score of one point per question for\n    // that includes our best guess if a question was skipped.\n    checkScore() {\n        this.correctStr = \"\";\n        this.skippedStr = \"\";\n        this.incorrectStr = \"\";\n        // Gets the score of each problem\n        for (var i = 0; i < this.renderedQuestionArray.length; i++) {\n            var correct =\n                this.renderedQuestionArray[i].question.checkCorrectTimed();\n            if (correct == \"T\") {\n                this.score++;\n                this.correctStr = this.correctStr + (i + 1) + \", \";\n            } else if (correct == \"F\") {\n                this.incorrect++;\n                this.incorrectStr = this.incorrectStr + (i + 1) + \", \";\n            } else if (correct === null || correct === \"I\") {\n                this.skipped++;\n                this.skippedStr = this.skippedStr + (i + 1) + \", \";\n            } else {\n                // ignored question; just do nothing\n            }\n        }\n        // remove extra comma and space at end if any\n        if (this.correctStr.length > 0)\n            this.correctStr = this.correctStr.substring(\n                0,\n                this.correctStr.length - 2\n            );\n        else this.correctStr = \"None\";\n        if (this.skippedStr.length > 0)\n            this.skippedStr = this.skippedStr.substring(\n                0,\n                this.skippedStr.length - 2\n            );\n        else this.skippedStr = \"None\";\n        if (this.incorrectStr.length > 0)\n            this.incorrectStr = this.incorrectStr.substring(\n                0,\n                this.incorrectStr.length - 2\n            );\n        else this.incorrectStr = \"None\";\n    }\n    findTimeTaken() {\n        if (this.limitedTime) {\n            this.timeTaken = this.startingTime - this.timeLimit;\n        } else {\n            this.timeTaken = this.timeLimit;\n        }\n    }\n    storeScore() {\n        var storage_arr = [];\n        storage_arr.push(\n            this.score,\n            this.correctStr,\n            this.incorrect,\n            this.incorrectStr,\n            this.skipped,\n            this.skippedStr,\n            this.timeTaken\n        );\n        var timeStamp = new Date();\n        var storageObj = JSON.stringify({\n            answer: storage_arr,\n            timestamp: timeStamp,\n        });\n        localStorage.setItem(this.localStorageKey(), storageObj);\n    }\n    // _`timed exam endpoint parameters`\n    //----------------------------------\n    logScore() {\n        this.logBookEvent({\n            event: \"timedExam\",\n            act: \"finish\",\n            div_id: this.divid,\n            correct: this.score,\n            incorrect: this.incorrect,\n            skipped: this.skipped,\n            time_taken: this.timeTaken,\n        });\n    }\n    shouldUseServer(data) {\n        // We override the RunestoneBase version because there is no \"correct\" attribute, and there are 2 possible localStorage schemas\n        // --we also want to default to local storage because it contains more information specifically which questions are correct, incorrect, and skipped.\n        var storageDate;\n        if (localStorage.length === 0) return true;\n        var storageObj = localStorage.getItem(this.localStorageKey());\n        if (storageObj === null) return true;\n        try {\n            var storedData = JSON.parse(storageObj).answer;\n            if (storedData.length == 4) {\n                if (\n                    data.correct == storedData[0] &&\n                    data.incorrect == storedData[1] &&\n                    data.skipped == storedData[2] &&\n                    data.timeTaken == storedData[3]\n                )\n                    return true;\n            } else if (storedData.length == 7) {\n                if (\n                    data.correct == storedData[0] &&\n                    data.incorrect == storedData[2] &&\n                    data.skipped == storedData[4] &&\n                    data.timeTaken == storedData[6]\n                ) {\n                    return false; // In this case, because local storage has more info, we want to use that if it's consistent\n                }\n            }\n            storageDate = new Date(JSON.parse(storageObj[1]).timestamp);\n        } catch (err) {\n            // error while parsing; likely due to bad value stored in storage\n            console.log(err.message);\n            localStorage.removeItem(this.localStorageKey());\n            return true;\n        }\n        var serverDate = new Date(data.timestamp);\n        if (serverDate < storageDate) {\n            this.logScore();\n            return false;\n        }\n        return true;\n    }\n\n    checkLocalStorage() {\n        var len = localStorage.length;\n        if (len > 0) {\n            if (localStorage.getItem(this.localStorageKey()) !== null) {\n                this.taken = 1;\n                this.restoreAnswers(\"\");\n            } else {\n                this.taken = 0;\n            }\n        } else {\n            this.taken = 0;\n        }\n    }\n    async restoreAnswers(data) {\n        this.taken = 1;\n        var tmpArr;\n        if (data === \"\") {\n            try {\n                tmpArr = JSON.parse(\n                    localStorage.getItem(this.localStorageKey())\n                ).answer;\n            } catch (err) {\n                // error while parsing; likely due to bad value stored in storage\n                console.log(err.message);\n                localStorage.removeItem(this.localStorageKey());\n                this.taken = 0;\n                return;\n            }\n        } else {\n            // Parse results from the database\n            tmpArr = [\n                parseInt(data.correct),\n                parseInt(data.incorrect),\n                parseInt(data.skipped),\n                parseInt(data.time_taken),\n                data.reset,\n            ];\n            this.setLocalStorage(tmpArr);\n        }\n        if (tmpArr.length == 1) {\n            // Exam was previously reset\n            this.reset = true;\n            this.taken = 0;\n            return;\n        }\n        if (tmpArr.length == 4) {\n            // Accidental Reload OR Database Entry\n            this.score = tmpArr[0];\n            this.incorrect = tmpArr[1];\n            this.skipped = tmpArr[2];\n            this.timeTaken = tmpArr[3];\n        } else if (tmpArr.length == 5) {\n            this.score = tmpArr[0];\n            this.incorrect = tmpArr[1];\n            this.skipped = tmpArr[2];\n            this.timeTaken = tmpArr[3];\n        } else if (tmpArr.length == 7) {\n            // Loaded Completed Exam\n            this.score = tmpArr[0];\n            this.correctStr = tmpArr[1];\n            this.incorrect = tmpArr[2];\n            this.incorrectStr = tmpArr[3];\n            this.skipped = tmpArr[4];\n            this.skippedStr = tmpArr[5];\n            this.timeTaken = tmpArr[6];\n        } else {\n            // Set localStorage in case of \"accidental\" reload\n            this.score = 0;\n            this.incorrect = 0;\n            this.skipped = this.renderedQuestionArray.length;\n            this.timeTaken = 0;\n        }\n        if (this.taken) {\n            if (this.skipped === this.renderedQuestionArray.length) {\n                this.showFeedback = false;\n            }\n            this.handlePrevAssessment();\n        }\n        await this.renderTimedQuestion();\n        this.displayScore();\n        this.showTime();\n    }\n    setLocalStorage(parsedData) {\n        var timeStamp = new Date();\n        var storageObj = {\n            answer: parsedData,\n            timestamp: timeStamp,\n        };\n        localStorage.setItem(\n            this.localStorageKey(),\n            JSON.stringify(storageObj)\n        );\n    }\n    displayScore() {\n        if (this.showResults) {\n            var scoreString = \"\";\n            var numQuestions;\n            var percentCorrect;\n            // if we have some information\n            if (\n                this.correctStr.length > 0 ||\n                this.incorrectStr.length > 0 ||\n                this.skippedStr.length > 0\n            ) {\n                scoreString = `Num Correct: ${this.score}. Questions: ${this.correctStr}<br>Num Wrong: ${this.incorrect}. Questions: ${this.incorrectStr}<br>Num Skipped: ${this.skipped}. Questions: ${this.skippedStr}<br>`;\n                numQuestions = this.score + this.incorrect + this.skipped;\n                percentCorrect = (this.score / numQuestions) * 100;\n                scoreString +=\n                    \"Percent Correct: \" + percentCorrect.toFixed(2) + \"%\";\n                $(this.scoreDiv).html(scoreString);\n                this.scoreDiv.style.display = \"block\";\n            } else {\n                scoreString = `Num Correct: ${this.score}<br>Num Wrong: ${this.incorrect}<br>Num Skipped: ${this.skipped}<br>`;\n                numQuestions = this.score + this.incorrect + this.skipped;\n                percentCorrect = (this.score / numQuestions) * 100;\n                scoreString +=\n                    \"Percent Correct: \" + percentCorrect.toFixed(2) + \"%\";\n                $(this.scoreDiv).html(scoreString);\n                this.scoreDiv.style.display = \"block\";\n            }\n            this.highlightNumberedList();\n        } else {\n            $(this.scoreDiv).html(\n                \"Thank you for taking the exam.  Your answers have been recorded.\"\n            );\n            this.scoreDiv.style.display = \"block\";\n        }\n    }\n    highlightNumberedList() {\n        var correctCount = this.correctStr;\n        var incorrectCount = this.incorrectStr;\n        var skippedCount = this.skippedStr;\n        correctCount = correctCount.replace(/ /g, \"\").split(\",\");\n        incorrectCount = incorrectCount.replace(/ /g, \"\").split(\",\");\n        skippedCount = skippedCount.replace(/ /g, \"\").split(\",\");\n        $(function () {\n            var numberedBtns = $(\"ul#pageNums > ul > li\");\n            if (numberedBtns.hasClass(\"answered\")) {\n                numberedBtns.removeClass(\"answered\");\n            }\n            for (var i = 0; i < correctCount.length; i++) {\n                var test = parseInt(correctCount[i]) - 1;\n                numberedBtns\n                    .eq(parseInt(correctCount[i]) - 1)\n                    .addClass(\"correctCount\");\n            }\n            for (var j = 0; j < incorrectCount.length; j++) {\n                numberedBtns\n                    .eq(parseInt(incorrectCount[j]) - 1)\n                    .addClass(\"incorrectCount\");\n            }\n            for (var k = 0; k < skippedCount.length; k++) {\n                numberedBtns\n                    .eq(parseInt(skippedCount[k]) - 1)\n                    .addClass(\"skippedCount\");\n            }\n        });\n    }\n}\n\n/*=======================================================\n=== Function that calls the constructors on page load ===\n=======================================================*/\n$(document).on(\"runestone:login-complete\", function () {\n    $(\"[data-component=timedAssessment]\").each(function (index) {\n        window.componentMap[this.id] = new Timed({\n            orig: this,\n            useRunestoneServices: eBookConfig.useRunestoneServices,\n        });\n    });\n});\n"],"names":["ShortAnswer","constructor","opts","super","orig","this","useRunestoneServices","eBookConfig","origElem","divid","id","question","innerHTML","optional","attachURL","$","is","mathjax","attachment","placeholder","data","renderHTML","caption","addCaption","checkServer","Prism","highlightAllUnder","containerDiv","document","createElement","addClass","getAttribute","newForm","name","action","appendChild","fieldSet","firstLegendDiv","jInputDiv","jOptionsDiv","jLabel","jTextArea","self","onchange","isAnswered","attr","css","rows","cols","isTimed","feedbackDiv","removeClass","bind","renderedAnswer","buttonDiv","submitButton","type","textContent","onclick","checkCurrentAnswer","logCurrentAnswer","renderFeedback","randomSpan","otherOptionsDiv","attachDiv","graderactive","viewButton","viewFile","fileUpload","replaceWith","MathJax","queueMathJax","renderMath","value","replace","text","getElementById","val","setLocalStorage","answer","timestamp","Date","sid","event","act","div_id","logBookEvent","uploadFile","key","localStorageKey","localStorage","setItem","JSON","stringify","checkLocalStorage","length","ex","getItem","parse","err","console","log","message","removeItem","restoreAnswers","p","tsString","toLocaleString","last_answer","current_answer","toggle_answer_button","click","display_timestamp","button_text","last_timestamp","feedbackStr","score","comment","disableInteraction","disabled","files","FormData","append","fetch","method","body","then","response","json","catch","error","window","open","write","alert","on","each","closest","componentMap","TimedShortAnswer","renderTimedIcon","hideButtons","hide","component","timeIconDiv","timeIcon","src","style","className","title","prepend","checkCorrectTimed","hideFeedback","component_factory","shortanswer","timed","Timed","children","childNodes","visited","timeLimit","limitedTime","isNaN","parseInt","startingTime","showFeedback","showResults","random","showTimer","fullwidth","nopause","enableScratchAC","running","paused","done","taken","incorrect","correctStr","incorrectStr","skippedStr","skipped","currentQuestionIndex","renderedQuestionArray","getNewChildren","enableDebug","oncontextmenu","checkAssessmentStatus","renderTimedAssess","newChildren","runestoneChildren","querySelectorAll","i","push","sendInfo","course_name","course","request","Request","new_server_prefix","headers","jsonHeaders","detail","tookAssessment","assessmentTaken","clear","Promise","resolve","createRenderedQuestionArray","randomizeRQA","renderContainer","renderTimer","renderControlButtons","timedDiv","renderNavControls","renderSubmitButton","renderFeedbackContainer","styleExamElements","classList","add","navDiv","flagDiv","switchContainer","switchDiv","wrapperDiv","timerContainer","showTime","controlDiv","startBtn","pauseBtn","class","tabindex","role","addEventListener","async","finishButton","flagButton","show","mess","renderTimedQuestion","startAssessment","pauseAssessment","tmpLi","tmpA","pagNavList","leftContainer","leftNavButton","rightNavButton","flaggingPlace","flagContainer","rightContainer","ensureButtonSafety","break","qNumList","qNumWrapperList","navBtnListeners","flagBtnListener","navigateAway","state","handleNextPrev","target","match","hasClass","j","handleFlag","handleNumberedNav","oldIndex","buttonContainer","filter","x","skipstr","confirm","finishAssessment","scoreDiv","display","tmpChild","timedWrapper","initAttempts","temporaryValue","randomIndex","currentIndex","Math","floor","currentQuestion","rqa","newq","initialize","e","componentKind","component_ready_promise","includes","contains","needsReinitialization","reinitializeListeners","handlePrevAssessment","restoreAnsweredQuestions","lastTime","now","increment","timeStamp","storageObj","preventDefault","returnValue","mins","secs","minsString","secsString","beginning","timeString","minutes","timeTaken","seconds","timeTips","getElementsByClassName","setTimeout","currentTime","email","width","margin","border","padding","color","findTimeTaken","finalizeProblems","checkScore","displayScore","storeScore","logScore","off","assignment_id","jQuery","ajax","url","app","dataType","is_timed","success","retdata","hideTimedFeedback","correct","substring","storage_arr","time_taken","shouldUseServer","storageDate","storedData","tmpArr","reset","parsedData","numQuestions","scoreString","toFixed","html","highlightNumberedList","correctCount","incorrectCount","skippedCount","split","numberedBtns","eq","k","index"],"sourceRoot":""}