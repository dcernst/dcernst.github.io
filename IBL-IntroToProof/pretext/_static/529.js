"use strict";(self.webpackChunkWebComponents=self.webpackChunkWebComponents||[]).push([[529],{58529:(e,t,i)=>{i.r(t),i.d(t,{default:()=>s});var r=i(78673);class c extends r.A{constructor(e){super(e);var t=e.orig;this.origElem=t,this.divid=t.id,this.useRunestoneServices=e.useRunestoneServices,this.clickableArray=[],this.correctArray=[],this.incorrectArray=[],this.isTable=!1,void 0!==$(this.origElem).data("cc")&&($(this.origElem).is("[data-table]")?(this.isTable=!0,this.ccArray=$(this.origElem).data("cc").split(";"),this.ciArray=$(this.origElem).data("ci").split(";")):(this.ccArray=$(this.origElem).data("cc").split(","),this.ciArray=$(this.origElem).data("ci").split(","))),this.clickIndex=0,this.clickableCounter=0,this.getQuestion(),this.getFeedback(),this.renderNewElements(),this.caption="Clickable",this.addCaption("runestone"),this.checkServer("clickableArea",!0),"undefined"!=typeof Prism&&Prism.highlightAllUnder(this.containerDiv)}getQuestion(){for(var e=0;e<this.origElem.childNodes.length;e++)if($(this.origElem.childNodes[e]).is("[data-question]")){this.question=this.origElem.childNodes[e];break}}getFeedback(){this.feedback="";for(var e=0;e<this.origElem.childNodes.length;e++)$(this.origElem.childNodes[e]).is("[data-feedback]")&&(this.feedback=this.origElem.childNodes[e]);""!==this.feedback&&($(this.feedback).remove(),this.feedback=this.feedback.innerHTML)}renderNewElements(){this.containerDiv=document.createElement("div"),this.containerDiv.id=this.origElem.id,this.containerDiv.appendChild(this.question),$(this.containerDiv).addClass(this.origElem.getAttribute("class")),this.newDiv=document.createElement("div");for(var e=$(this.origElem).html();"\n"===e[0];)e=e.slice(1);this.newDiv.innerHTML=e,this.containerDiv.appendChild(this.newDiv),this.createButtons(),this.createFeedbackDiv(),$(this.origElem).replaceWith(this.containerDiv)}createButtons(){this.submitButton=document.createElement("button"),this.submitButton.textContent="Check Me",$(this.submitButton).attr({class:"btn btn-success",name:"do answer",type:"button"}),this.submitButton.onclick=function(){this.checkCurrentAnswer(),this.logCurrentAnswer(),this.renderFeedback()}.bind(this),this.containerDiv.appendChild(this.submitButton)}createFeedbackDiv(){this.feedBackDiv=document.createElement("div"),this.containerDiv.appendChild(document.createElement("br")),this.containerDiv.appendChild(this.feedBackDiv)}restoreAnswers(e){void 0!==e.answer&&(this.hasStoredAnswers=!0,this.clickedIndexArray=e.answer.split(";")),void 0===this.ccArray?this.modifyClickables(this.newDiv.childNodes):(this.ccCounter=0,this.ccIndex=0,this.ciIndex=0,this.isTable?this.modifyTableViaCC(this.newDiv.children):this.modifyViaCC(this.newDiv.children))}checkLocalStorage(){if(!this.graderactive){var e;if(this.hasStoredAnswers=!1,localStorage.length>0){var t=localStorage.getItem(this.localStorageKey());if(null!==t){this.hasStoredAnswers=!0;try{e=JSON.parse(t),this.clickedIndexArray=e.answer.split(";")}catch(e){return console.log(e.message),localStorage.removeItem(this.localStorageKey()),this.hasStoredAnswers=!1,void this.restoreAnswers({})}if(this.useRunestoneServices){this.givenIndexArray=[];for(var i=0;i<this.clickableArray.length;i++)$(this.clickableArray[i]).hasClass("clickable-clicked")&&this.givenIndexArray.push(i);this.logBookEvent({event:"clickableArea",act:this.clickedIndexArray.join(";"),answer:this.clickedIndexArray.join(";"),div_id:this.divid,correct:e.correct})}}}this.restoreAnswers({})}}setLocalStorage(e){var t;if(void 0!==e.answer)t=this.clickedIndexArray.join(";");else{this.givenIndexArray=[];for(var i=0;i<this.clickableArray.length;i++)$(this.clickableArray[i]).hasClass("clickable-clicked")&&this.givenIndexArray.push(i);t=this.givenIndexArray.join(";")}var r=new Date,c={answer:t,correct:e.correct,timestamp:r};localStorage.setItem(this.localStorageKey(),JSON.stringify(c))}modifyClickables(e){for(var t=0;t<e.length;t++)($(e[t]).is("[data-correct]")||$(e[t]).is("[data-incorrect]"))&&(this.manageNewClickable(e[t]),$(e[t]).is("[data-correct]")?($(e[t]).removeAttr("data-correct"),this.correctArray.push(e[t])):($(e[t]).removeAttr("data-incorrect"),this.incorrectArray.push(e[t]))),0!==e[t].childNodes.length&&this.modifyClickables(e[t].childNodes)}modifyViaCC(e){for(var t=0;t<e.length;t++)0!==e[t].children.length?this.modifyViaCC(e[t].children):(this.ccCounter++,this.ccCounter===Math.floor(this.ccArray[this.ccIndex])?(this.manageNewClickable(e[t]),this.correctArray.push(e[t]),this.ccIndex++):this.ccCounter===Math.floor(this.ciArray[this.ciIndex])&&(this.manageNewClickable(e[t]),this.incorrectArray.push(e[t]),this.ciIndex++))}modifyTableViaCC(e){var t=[];for(let i=0;i<e.length;i++)if("TABLE"===e[i].nodeName){let r=e[i];for(let e=0;e<r.children.length;e++)("THEAD"===r.children[e].nodeName||"TBODY"===r.children[e].nodeName||"TFOOT"===r.children[e].nodeName)&&t.push(r.children[e])}for(var i=0;i<t.length;i++)for(let e=0;e<t[i].children.length;e++)if(this.ccCounter++,this.ccIndex<this.ccArray.length&&this.ccCounter===Math.floor(this.ccArray[this.ccIndex].split(",")[0])&&0===Math.floor(this.ccArray[this.ccIndex].split(",")[1]))this.manageNewClickable(t[i].children[e]),this.correctArray.push(t[i].children[e]),this.ccIndex++;else if(this.ciIndex<this.ciArray.length&&this.ccCounter===Math.floor(this.ciArray[this.ciIndex].split(",")[0])&&0===Math.floor(this.ciArray[this.ciIndex].split(",")[1]))this.manageNewClickable(t[i].children[e]),this.incorrectArray.push(t[i].children[e]),this.ciIndex++;else for(let r=0;r<t[i].children[e].children.length;r++){let c=r+1;this.ccIndex<this.ccArray.length&&c===Math.floor(this.ccArray[this.ccIndex].split(",")[1])&&this.ccCounter===Math.floor(this.ccArray[this.ccIndex].split(",")[0])?(this.manageNewClickable(t[i].children[e].children[r]),this.correctArray.push(t[i].children[e].children[r]),this.ccIndex++):this.ciIndex<this.ciArray.length&&c===Math.floor(this.ciArray[this.ciIndex].split(",")[1])&&this.ccCounter===Math.floor(this.ciArray[this.ciIndex].split(",")[0])&&(this.manageNewClickable(t[i].children[e].children[r]),this.incorrectArray.push(t[i].children[e].children[r]),this.ciIndex++)}}manageNewClickable(e){$(e).addClass("clickable"),this.hasStoredAnswers&&this.clickedIndexArray[this.clickIndex].toString()===this.clickableCounter.toString()&&($(e).addClass("clickable-clicked"),this.clickIndex++,this.clickIndex===this.clickedIndexArray.length&&(this.hasStoredAnswers=!1));let t=this;e.onclick=function(){t.isAnswered=!0,$(this).hasClass("clickable-clicked")?($(this).removeClass("clickable-clicked"),$(this).removeClass("clickable-incorrect")):$(this).addClass("clickable-clicked")},this.clickableArray.push(e),this.clickableCounter++}checkCurrentAnswer(){this.correct=!0,this.correctNum=0,this.incorrectNum=0;for(let e=0;e<this.correctArray.length;e++)$(this.correctArray[e]).hasClass("clickable-clicked")?this.correctNum++:this.correct=!1;for(let e=0;e<this.incorrectArray.length;e++)$(this.incorrectArray[e]).hasClass("clickable-clicked")?(this.correct=!1,this.incorrectNum++):$(this.incorrectArray[e]).removeClass("clickable-incorrect");this.percent=(this.correctNum-this.incorrectNum)/this.correctArray.length,this.percent=Math.max(0,this.percent),this.setLocalStorage({correct:this.correct?"T":"F"})}async logCurrentAnswer(e){const t=this.givenIndexArray.join(";");let i={event:"clickableArea",answer:t,act:t,div_id:this.divid,correct:this.correct?"T":"F"};void 0!==e&&(i.sid=e),await this.logBookEvent(i)}renderFeedback(){if(this.correct)$(this.feedBackDiv).html("You are Correct!"),$(this.feedBackDiv).attr("class","alert alert-info");else{for(let e=0;e<this.incorrectArray.length;e++)$(this.incorrectArray[e]).hasClass("clickable-clicked")?$(this.incorrectArray[e]).addClass("clickable-incorrect"):$(this.incorrectArray[e]).removeClass("clickable-incorrect");$(this.feedBackDiv).html("Incorrect. You clicked on "+this.correctNum+" of the "+this.correctArray.length.toString()+" correct elements and "+this.incorrectNum+" of the "+this.incorrectArray.length.toString()+" incorrect elements. "+this.feedback),$(this.feedBackDiv).attr("class","alert alert-danger")}}disableInteraction(){for(var e=0;e<this.clickableArray.length;e++)$(this.clickableArray[e]).css("cursor","initial"),this.clickableArray[e].onclick=function(){}}}$(document).on("runestone:login-complete",(function(){$("[data-component=clickablearea]").each((function(e){if(0==$(this).closest("[data-component=timedAssessment]").length)try{window.componentMap[this.id]=new c({orig:this,useRunestoneServices:eBookConfig.useRunestoneServices})}catch(e){console.log(`Error rendering ClickableArea Problem ${this.id}\n                             Details: ${e}`)}}))}));class s extends c{constructor(e){super(e),this.assessmentTaken||this.restoreAnswers({}),this.renderTimedIcon(this.containerDiv),this.hideButtons()}hideButtons(){$(this.submitButton).hide()}renderTimedIcon(e){var t=document.createElement("div"),i=document.createElement("img");$(i).attr({src:"../_static/clock.png",style:"width:15px;height:15px"}),t.className="timeTip",t.title="",t.appendChild(i),$(e).prepend(t)}checkCorrectTimed(){switch(0===this.correctNum&&0===this.incorrectNum&&(this.correct=null),this.correct){case!0:return"T";case!1:return"F";default:return null}}hideFeedback(){$(this.feedBackDiv).hide()}}void 0===window.component_factory&&(window.component_factory={}),window.component_factory.clickablearea=function(e){return e.timed?new s(e):new c(e)}}}]);
//# sourceMappingURL=529.js.map