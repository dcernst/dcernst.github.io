"use strict";(self.webpackChunkWebComponents=self.webpackChunkWebComponents||[]).push([[919],{9919:(e,t,i)=>{i.r(t),i.d(t,{default:()=>n});var s=i(78673);class r extends s.A{constructor(e){super(e);var t=(e=e||{}).orig;this.origElem=t,this.useRunestoneServices=e.useRunestoneServices,this.multipleanswers=!1,this.divid=t.id,!0===$(this.origElem).data("multipleanswers")&&(this.multipleanswers=!0),this.children=this.origElem.childNodes,this.random=!1,$(this.origElem).is("[data-random]")&&(this.random=!0),this.correct=null,this.answerList=[],this.correctList=[],this.correctIndexList=[],this.feedbackList=[],this.question=null,this.caption="Multiple Choice",this.findAnswers(),this.findQuestion(),this.findFeedbacks(),this.createCorrectList(),this.createMCForm(),this.addCaption("runestone"),this.checkServer("mChoice",!0),this.queueMathJax(this.containerDiv),"undefined"!=typeof Prism&&Prism.highlightAllUnder(this.containerDiv)}findQuestion(){for(var e,t=0;t<this.origElem.childNodes.length;t++)if("LI"===this.origElem.childNodes[t].nodeName){e=this.origElem.childNodes[t].outerHTML;break}var i=$(this.origElem).html().split(e);this.question=i[0]}findAnswers(){for(var e=[],t=0;t<this.children.length;t++)$(this.children[t]).is("[data-component=answer]")&&e.push(this.children[t]);for(var i=0;i<e.length;i++){var s=$(e[i]).attr("id"),r=!1;$(e[i]).is("[data-correct]")&&(r=!0);var n={id:s,correct:r,content:$(e[i]).html()};this.answerList.push(n)}}findFeedbacks(){for(var e=0;e<this.children.length;e++)$(this.children[e]).is("[data-component=feedback]")&&this.feedbackList.push(this.children[e].innerHTML)}createCorrectList(){for(var e=0;e<this.answerList.length;e++)this.answerList[e].correct&&(this.correctList.push(this.answerList[e].id),this.correctIndexList.push(e))}createMCForm(){this.renderMCContainer(),this.renderMCForm(),this.renderMCfeedbackDiv(),$(this.origElem).replaceWith(this.containerDiv)}renderMCContainer(){this.containerDiv=document.createElement("div"),$(this.containerDiv).html(this.question),$(this.containerDiv).addClass(this.origElem.getAttribute("class")),this.containerDiv.id=this.divid}renderMCForm(){this.optsForm=document.createElement("form"),this.optsForm.id=this.divid+"_form",$(this.optsForm).attr({method:"get",action:"",onsubmit:"return false;"}),this.renderMCFormOpts(),this.renderMCFormButtons(),this.containerDiv.appendChild(this.optsForm)}renderMCFormOpts(){this.optionArray=[];var e="radio";this.multipleanswers&&(e="checkbox"),this.indexArray=[];for(var t=0;t<this.answerList.length;t++)this.indexArray.push(t);this.random&&this.randomizeAnswers();let i=this,s=function(){i.isAnswered=!0};for(var r=0;r<this.answerList.length;r++){var n=this.indexArray[r],o=this.divid+"_opt_"+n,a=document.createElement("label"),h=this.answerList[n].content,c="";h.startsWith("<p>")&&(c="<p>",h=h.slice(3)),$(a).html(`${c}<input type="${e}" name="group1" value=${n} id=${o}>${String.fromCharCode("A".charCodeAt(0)+r)}. ${h}`);var d={input:$(a).find("input")[0],label:a};d.input.onclick=s,this.optionArray.push(d),this.optsForm.appendChild(a),this.optsForm.appendChild(document.createElement("br"))}}renderMCFormButtons(){this.submitButton=document.createElement("button"),this.submitButton.textContent="Check Me",$(this.submitButton).attr({class:"btn btn-success",name:"do answer",type:"button"}),this.multipleanswers?this.submitButton.addEventListener("click",function(){this.processMCMASubmission(!0)}.bind(this),!1):this.submitButton.addEventListener("click",function(e){e.preventDefault(),this.processMCMFSubmission(!0)}.bind(this),!1),this.optsForm.appendChild(this.submitButton),this.useRunestoneServices&&!eBookConfig.peer&&(this.compareButton=document.createElement("button"),$(this.compareButton).attr({class:"btn btn-default",id:this.divid+"_bcomp",disabled:"",name:"compare"}),this.compareButton.textContent="Compare me",this.compareButton.addEventListener("click",function(){this.compareAnswers(this.divid)}.bind(this),!1),this.optsForm.appendChild(this.compareButton))}renderMCfeedbackDiv(){this.feedBackDiv=document.createElement("div"),this.feedBackDiv.id=this.divid+"_feedback",this.containerDiv.appendChild(document.createElement("br")),this.containerDiv.appendChild(this.feedBackDiv)}randomizeAnswers(){for(var e,t,i=this.indexArray.length;0!==i;){t=Math.floor(Math.random()*i),i-=1,e=this.indexArray[i],this.indexArray[i]=this.indexArray[t],this.indexArray[t]=e;var s=this.feedbackList[i];this.feedbackList[i]=this.feedbackList[t],this.feedbackList[t]=s}}restoreAnswers(e){e.answer||(e.answer="");for(var t=e.answer.split(","),i=0;i<t.length;i++)for(var s=t[i],r=0;r<this.optionArray.length;r++)this.optionArray[r].input.value==s&&$(this.optionArray[r].input).attr("checked","true");this.multipleanswers?this.processMCMASubmission(!1):this.processMCMFSubmission(!1)}checkLocalStorage(){var e;if(!this.graderactive&&localStorage.length>0){var t=localStorage.getItem(this.localStorageKey());if(null!==t){try{e=JSON.parse(t).answer.split(",")}catch(e){return console.log(e.message),void localStorage.removeItem(this.localStorageKey())}for(var i=0;i<e.length;i++)for(var s=e[i],r=0;r<this.optionArray.length;r++)this.optionArray[r].input.value==s&&$(this.optionArray[r].input).attr("checked","true");this.useRunestoneServices&&(this.enableMCComparison(),this.getSubmittedOpts(),this.multipleanswers?this.logMCMAsubmission():this.logMCMFsubmission())}}}setLocalStorage(e){var t=new Date,i={answer:e.answer,timestamp:t,correct:e.correct};localStorage.setItem(this.localStorageKey(),JSON.stringify(i))}processMCMASubmission(e){this.getSubmittedOpts(),this.scoreMCMASubmission(),this.setLocalStorage({correct:this.correct?"T":"F",answer:this.givenArray.join(",")}),e&&this.logMCMAsubmission(),!eBookConfig.peer||eBookConfig.isInstructor?(this.renderMCMAFeedBack(),this.useRunestoneServices&&this.enableMCComparison()):eBookConfig.peer&&"async"===eBookConfig.peerMode&&"undefined"!=typeof studentVoteCount&&studentVoteCount>1?this.renderMCMAFeedBack():($(this.feedBackDiv).html("<p>Your Answer has been recorded</p>"),$(this.feedBackDiv).attr("class","alert alert-info"))}getSubmittedOpts(){var e;this.singlefeedback="",this.feedbackString="",this.givenArray=[],this.givenlog="";for(var t=this.optsForm.elements.group1,i=0;i<t.length;i++)t[i].checked&&(e=t[i].value,this.givenArray.push(e),this.feedbackString+=`<li value="${i+1}">${this.feedbackList[i]}</li>`,this.givenlog+=e+",",this.singlefeedback=this.feedbackList[i]);this.givenArray.sort()}checkCurrentAnswer(){this.getSubmittedOpts(),this.multipleanswers?this.scoreMCMASubmission():this.scoreMCMFSubmission()}async logCurrentAnswer(e){this.multipleanswers?await this.logMCMAsubmission(e):await this.logMCMFsubmission(e)}renderFeedback(){this.multipleanswers?this.renderMCMAFeedBack():this.renderMCMFFeedback()}scoreMCMASubmission(){this.correctCount=0;for(var e=0,t=0;e<this.correctIndexList.length&&t<this.givenArray.length;)this.givenArray[t]<this.correctIndexList[e]?t++:this.givenArray[t]==this.correctIndexList[e]?(this.correctCount++,t++,e++):e++;var i=this.givenArray.length,s=this.correctCount,r=this.correctList.length;this.answer=this.givenArray.join(","),this.correct=s===r&&r===i,this.percent=i===r?s/r:s/Math.max(i,r)}async logMCMAsubmission(e){var t=this.answer||"",i=this.correct||"F";let s={event:"mChoice",act:"answer:"+t+":"+("T"==i?"correct":"no"),answer:t,correct:i,div_id:this.divid};eBookConfig.peer&&"undefined"!=typeof studentVoteCount&&(s.act=s.act+`:vote${studentVoteCount}`),void 0!==e&&(s.sid=e),await this.logBookEvent(s)}renderMCMAFeedBack(){var e="answers",t=this.givenArray.length;1===t&&(e="answer");var i=this.correctCount,s=this.correctList.length,r=this.feedbackString;this.correct?($(this.feedBackDiv).html(`✔️ <ol type="A">${r}</ul>`),$(this.feedBackDiv).attr("class","alert alert-info")):($(this.feedBackDiv).html(`✖️ You gave ${t} ${e} and got ${i} correct of ${s} needed.<ol type="A">${r}</ul>`),$(this.feedBackDiv).attr("class","alert alert-danger"))}processMCMFSubmission(e){this.getSubmittedOpts(),this.scoreMCMFSubmission(),this.setLocalStorage({correct:this.correct?"T":"F",answer:this.givenArray.join(",")}),e&&this.logMCMFsubmission(),!eBookConfig.peer||eBookConfig.isInstructor?(this.renderMCMFFeedback(),this.useRunestoneServices&&this.enableMCComparison()):eBookConfig.peer&&"async"===eBookConfig.peerMode&&"undefined"!=typeof studentVoteCount&&studentVoteCount>1?this.renderMCMAFeedBack():($(this.feedBackDiv).html("<p>Your Answer has been recorded</p>"),$(this.feedBackDiv).attr("class","alert alert-info"))}scoreMCMFSubmission(){this.answer=this.givenArray[0],this.givenArray[0]==this.correctIndexList[0]?(this.correct=!0,this.percent=1):null!=this.givenArray[0]&&(this.correct=!1,this.percent=0)}async logMCMFsubmission(e){var t=this.givenArray[0]||"",i=this.givenArray[0]==this.correctIndexList[0]?"T":"F";let s={event:"mChoice",act:"answer:"+t+":"+("T"==i?"correct":"no"),answer:t,correct:i,div_id:this.divid};eBookConfig.peer&&"undefined"!=typeof studentVoteCount&&(s.act=s.act+`:vote${studentVoteCount}`),void 0!==e&&(s.sid=e),await this.logBookEvent(s)}renderMCMFFeedback(){let e=this.givenArray[0]==this.correctIndexList[0],t=this.singlefeedback;e?($(this.feedBackDiv).html("✔️ "+t),$(this.feedBackDiv).attr("class","alert alert-info")):(null==t&&(t=""),$(this.feedBackDiv).html("✖️ "+t),$(this.feedBackDiv).attr("class","alert alert-danger"))}enableMCComparison(){eBookConfig.enableCompareMe&&(this.compareButton.disabled=!1)}instructorMchoiceModal(e){var t="<table><tr><th>Student</th><th>Answer(s)</th></tr>";for(var i in e)t+="<tr><td>"+e[i][0]+"</td><td>"+e[i][1]+"</td></tr>";return t+"</table>"}compareModal(e,t,i){var s=e.detail,r=s.answerDict,n=s.misc,o=Object.keys(r).sort(),a="<table>";a+="<tr><th>Answer</th><th>Percent</th></tr>";var h="";for(var c in o){h=o[c]===n.correct?"success":"info",a+="<tr><td>"+o[c]+"</td><td class='compare-me-progress'>";var d=r[o[c]]+"%";a+="<div class='progress'>",a+="    <div class='progress-bar progress-bar-"+h+"' style='width:"+d+";'>"+d,a+="    </div>",a+="</div></td></tr>"}a+="</table>","unavailable"!==n.yourpct&&(a+="<br /><p>You have "+n.yourpct+"% correct for all questions</p>"),void 0!==s.reslist&&(a+=this.instructorMchoiceModal(s.reslist)),$("<div class='modal fade'>    <div class='modal-dialog compare-modal'>        <div class='modal-content'>            <div class='modal-header'>                <button type='button' class='close' data-dismiss='modal' aria-hidden='true'>&times;</button>                <h4 class='modal-title'>Distribution of Answers</h4>            </div>            <div class='modal-body'>"+a+"            </div>        </div>    </div></div>").modal()}compareAnswers(){var e={};e.div_id=this.divid,e.course_name=eBookConfig.course,jQuery.get(`${eBookConfig.new_server_prefix}/assessment/getaggregateresults`,e,this.compareModal.bind(this))}disableInteraction(){for(var e=0;e<this.optionArray.length;e++)this.optionArray[e].input.disabled=!0}enableInteraction(){for(var e=0;e<this.optionArray.length;e++)this.optionArray[e].input.disabled=!1}}$(document).on("runestone:login-complete",(function(){$("[data-component=multiplechoice]").each((function(e){var t={orig:this,useRunestoneServices:eBookConfig.useRunestoneServices};0==$(this).closest("[data-component=timedAssessment]").length&&(window.componentMap[this.id]=new r(t))}))}));class n extends r{constructor(e){super(e),$(this.containerDiv).addClass("runestone"),this.needsReinitialization=!0,this.renderTimedIcon(this.MCContainer),this.hideButtons()}renderTimedIcon(e){var t=document.createElement("div"),i=document.createElement("img");$(i).attr({src:"../_static/clock.png",style:"width:15px;height:15px"}),t.className="timeTip",t.title="",t.appendChild(i),$(e).prepend(t)}hideButtons(){$(this.submitButton).attr("disabled","true"),$(this.submitButton).hide(),$(this.compareButton).hide()}renderMCMAFeedBack(){this.feedbackTimedMC()}renderMCMFFeedback(e,t){this.feedbackTimedMC()}feedbackTimedMC(){for(var e=0;e<this.indexArray.length;e++){var t=this.indexArray[e];$(this.feedBackEachArray[e]).html(String.fromCharCode(65+e)+". "+this.feedbackList[e]);var i=this.answerList[t].id;this.correctList.indexOf(i)>=0?this.feedBackEachArray[e].classList.add("alert","alert-success"):this.feedBackEachArray[e].classList.add("alert","alert-danger")}}renderMCFormOpts(){super.renderMCFormOpts(),this.feedBackEachArray=[];for(var e=0;e<this.answerList.length;e++){var t=this.indexArray[e],i=document.createElement("div");i.id=this.divid+"_eachFeedback_"+t,i.classList.add("eachFeedback"),this.feedBackEachArray.push(i),this.optsForm.appendChild(i)}}checkCorrectTimedMCMA(){switch(this.correctCount===this.correctList.length&&this.correctList.length===this.givenArray.length?this.correct=!0:0!==this.givenArray.length?this.correct=!1:this.correct=null,this.correct){case!0:return"T";case!1:return"F";default:return null}}checkCorrectTimedMCMF(){switch(this.correct){case!0:return"T";case!1:return"F";default:return null}}checkCorrectTimed(){return this.multipleanswers?this.checkCorrectTimedMCMA():this.checkCorrectTimedMCMF()}hideFeedback(){for(var e=0;e<this.feedBackEachArray.length;e++)$(this.feedBackEachArray[e]).hide()}reinitializeListeners(){let e=this,t=function(){e.isAnswered=!0};for(let e of this.optionArray)e.input.onclick=t}}void 0===window.component_factory&&(window.component_factory={}),window.component_factory.multiplechoice=function(e){return e.timed?new n(e):new r(e)}}}]);
//# sourceMappingURL=919.js.map