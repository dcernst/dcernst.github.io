<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
<meta http-equiv="Content-Language" Content="en">
<title>8.4 Integration by Parts</title>
<!--
<script type="text/javascript" src="js/deployJava.js"></script>
<link rel="stylesheet" type="text/css" href="http://jsxgraph.uni-bayreuth.de/distrib/jsxgraph.css" />
-->
<!-- use Jsxgraph to create figures: http://jsxgraph.uni-bayreuth.de/wp/ -->
<link rel="stylesheet" type="text/css" href="css/jsxgraph.css" />
<script type="text/javascript" src="js/jsxgraphcore.js"></script>
<script src="js/three.min.js"></script>
<script src="js/Detector.js"></script>
<script src="js/TrackballControls.js"></script>
<script src="js/OrthographicTrackballControls.js"></script>
<script src="js/THREEx.KeyboardState.js"></script>
<script src="js/THREEx.FullScreen.js"></script>
<script src="js/THREEx.WindowResize.js"></script>
<script type='text/javascript' src='js/DAT.GUI.min.js'></script>
<script>
window.requestAnimFrame = (function(){
    return  window.requestAnimationFrame       || 
        window.webkitRequestAnimationFrame || 
        window.mozRequestAnimationFrame    || 
        window.oRequestAnimationFrame      || 
        window.msRequestAnimationFrame     || 
        function(/* function */ callback, /* DOMElement */
            element){
            window.setTimeout(callback, 1000 / 60);
        };
})();
</script>
<script src="js/ifvisible.min.js"></script>
<script src="js/conrec.js"></script>
<script>
active = true;
ifvisible.setIdleDuration(10);
ifvisible.on("idle", function(){
    active = false;
//    console.log("idle");
});

ifvisible.on("wakeup", function(){
    active = true;
//    console.log("wakeup");
});
</script>
<script src="js/parser.js"></script>
<link href="css/whitman.css" rel="stylesheet" type="text/css" /><link href="css/calculus.css" rel="stylesheet" type="text/css" /><link href="css/knowlstyle.css" rel="stylesheet" type="text/css" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
  tex2jax: {
    inlineMath: [['$','$'],["\\(","\\)"]],
    processEscapes: true,
  },
TeX: {
   Macros: {
    val: "\\mathop{\\rm val}",
    divides: "\\mid",
    ndivides: "\\mathrel{\\not|}",
    fix: "\\mathop{\\rm fix}",
    id: "\\mathop{\\rm id}",
    na: "\\mathop{\\rm na}",
    d: "\\mathop{\\rm\\strut d}\\nolimits ",
    legendre: ["\\left(\\frac{#1}{#2}\\right)",2],
    normalbaselines: "",
    notdiv: "\\nmid",
    implies: "\\Rightarrow",
    iff: "\\Leftrightarrow",
    sevenpoint: "\\scriptsize",
    ds: "\\displaystyle",
    lcm: "\\operatorname{lcm}",
    arccot: "\\operatorname{arccot}",
    arcsec: "\\operatorname{arcsec}",
    arccsc: "\\operatorname{arccsc}",
    arccosh: "\\operatorname{arccosh}",
    arcsinh: "\\operatorname{arcsinh}",
    arcsech: "\\operatorname{arcsech}",
    sech: "\\operatorname{sech}",
    csch: "\\operatorname{csch}",
    R: "{\\mathbb R}",
    sb: "_",
    sp: "^",
    Q: "{\\mathbb Q}",
    C: "{\\mathbb C}",
    N: "{\\mathbb N}",
    Z: "{\\mathbb Z}",
    U: "{\\mathbb U}",
    v: ["\\langle #1\\rangle",1],
    dint: ["{\\mathchoice{\\mathop{\\int\\!\\!\\!\\int}_{#1}}{\\mathop{\\int\\!\\!\\!\\int}_{#1}}{\\mathop{\\int\\!\\!\\!\\int}}{\\mathop{\\int\\!\\!\\!\\int}}}",1],
    tint: ["{\\mathchoice{\\mathop{\\int\\!\\!\\!\\int\\!\\!\\!\\int}_{#1\\;}}{\\mathop{\\int\\!\\!\\!\\int\\!\\!\\!\\int}_{#1}}{\\mathop{\\int\\!\\!\\!\\int\\!\\!\\!\\int}_{#1}}{\\mathop{\\int\\!\\!\\!\\int\\!\\!\\!\\int}_{#1}}}",1]
   }
},
  "HTML-CSS": { scale: 100},
  menuSettings: { zscale: "150%", zoom: "Double-Click" }
});
    JXG.Options.text.display = 'html';
    JXG.Options.text.useMathJax = true;
</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/math
jax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<script>
MathJax.Hub.Register.StartupHook("End",function () {
  if(typeof window.orientation === 'undefined'){
    var i,x;
    x = document.getElementsByClassName("webgl_display");
    for (i=0; i<x.length; i++) {
      x[i].style.display = "block";
    }
    x = document.getElementsByClassName("no_webgl_display");
    for (i=0; i<x.length; i++) {
      x[i].style.display = "none";
    }
  }
});
</script>

<script src="js/jquery-3.1.0.min.js"></script>
<script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script>
<script src="js/jquery.visible.min.js"></script>
<script type="text/javascript" src="js/knowl.js"></script>
<style type="text/css">

.sagecell .CodeMirror {
  height: auto;
}

.sagecell .CodeMirror-scroll {
  overflow-y: hidden;
  overflow-x: auto;
}

.sagecell-practice .CodeMirror-scroll {
}

.sagecell button.sagecell_evalButton {
    font-size: 50%;
}

.sagecell_sessionContainer {
    margin-bottom:1em;
}
</style>
<script>
function toggle(a) {
  var b = String(a);
  b=b.replace("contents","button");
  if (document.getElementById(a).style.display == "block") {
    document.getElementById(a).style.display = "none";
    document.getElementById(b).src = "expand_submenu.png";
  } else {
    document.getElementById(a).style.display = "block";
    document.getElementById(b).src = "collapse_submenu.png";
  }
}
function toggle_sidebar() {
  if (document.getElementById('sidebar').style.display == "block") {
    document.getElementById('sidebar').style.display = "none";
    document.getElementById('menu_expand').style.display = "block";
  } else {
    document.getElementById('sidebar').style.display = "block";
    document.getElementById('menu_expand').style.display = "none";
  }
}
</script>

</head>

<body class="" onload="toggle('chapter_08_contents')">
<div id="header">
<div class="right">
<div class="bread">
  <a href=".">Home</a> &raquo; <a href="chapter08.html">Techniques of Integration</a> &raquo; <a href="section08.04.html">Integration by Parts</a>
</div>

<FORM method=GET action=https://www.google.com/custom id="search">
<INPUT TYPE=text name=q size=31 maxlength=255 value="" style="font-size:small">
<INPUT type=submit name=sa VALUE="Search the book" style="font-size:small">
<INPUT type=hidden name=cof VALUE="AH:center;AWFID:198dc2b883340b1f;">
<input type=hidden name=domains value="www.whitman.edu">
<input type=hidden name=sitesearch value="www.whitman.edu/mathematics/calculus_online/">
</FORM>
<div id="title"><span id="title-content">8.4 Integration by Parts</span></div><a href="#exercises">[Jump to exercises]</a>
</div>
</div>
<div id="menu_expand" style="display:none"><a href="javascript:toggle_sidebar()">Expand menu</a></div>
<div id="sidebar" style="display:block">
<h2 id="menu_collapse"><a href='javascript:toggle_sidebar()'>Collapse menu</a></h2>
<h2 class="link"><img id="chapter_01_button" src="expand_submenu.png" onclick='toggle("chapter_01_contents")'><a href="chapter01.html">1 Analytic Geometry</a></h2>

<ul class="list" id="chapter_01_contents">
<li><a href="section01.01.html">1. Lines</a></li>
<li><a href="section01.02.html">2. Distance Between Two Points; Circles</a></li>
<li><a href="section01.03.html">3. Functions</a></li>
<li><a href="section01.04.html">4. Shifts and Dilations</a></li>
</ul>

<h2 class="link"><img id="chapter_02_button" src="expand_submenu.png" onclick='toggle("chapter_02_contents")'><a href="chapter02.html">2 Instantaneous Rate of Change:  The Derivative</a></h2>

<ul class="list" id="chapter_02_contents">
<li><a href="section02.01.html">1. The slope of a function</a></li>
<li><a href="section02.02.html">2. An example</a></li>
<li><a href="section02.03.html">3. Limits</a></li>
<li><a href="section02.04.html">4. The Derivative Function</a></li>
<li><a href="section02.05.html">5. Adjectives For Functions</a></li>
</ul>

<h2 class="link"><img id="chapter_03_button" src="expand_submenu.png" onclick='toggle("chapter_03_contents")'><a href="chapter03.html">3 Rules for Finding Derivatives</a></h2>

<ul class="list" id="chapter_03_contents">
<li><a href="section03.01.html">1. The Power Rule</a></li>
<li><a href="section03.02.html">2. Linearity of the Derivative</a></li>
<li><a href="section03.03.html">3. The Product Rule</a></li>
<li><a href="section03.04.html">4. The Quotient Rule</a></li>
<li><a href="section03.05.html">5. The Chain Rule</a></li>
</ul>

<h2 class="link"><img id="chapter_04_button" src="expand_submenu.png" onclick='toggle("chapter_04_contents")'><a href="chapter04.html">4 Transcendental Functions</a></h2>

<ul class="list" id="chapter_04_contents">
<li><a href="section04.01.html">1. Trigonometric Functions</a></li>
<li><a href="section04.02.html">2. The Derivative of $\sin x$</a></li>
<li><a href="section04.03.html">3. A hard limit</a></li>
<li><a href="section04.04.html">4. The Derivative of $\sin x$, continued</a></li>
<li><a href="section04.05.html">5. Derivatives of the Trigonometric Functions</a></li>
<li><a href="section04.06.html">6. Exponential and Logarithmic functions</a></li>
<li><a href="section04.07.html">7. Derivatives of the exponential and  logarithmic functions</a></li>
<li><a href="section04.08.html">8. Implicit Differentiation</a></li>
<li><a href="section04.09.html">9. Inverse Trigonometric Functions</a></li>
<li><a href="section04.10.html">10. Limits revisited</a></li>
<li><a href="section04.11.html">11. Hyperbolic Functions</a></li>
</ul>

<h2 class="link"><img id="chapter_05_button" src="expand_submenu.png" onclick='toggle("chapter_05_contents")'><a href="chapter05.html">5 Curve Sketching</a></h2>

<ul class="list" id="chapter_05_contents">
<li><a href="section05.01.html">1. Maxima and Minima</a></li>
<li><a href="section05.02.html">2. The first derivative test</a></li>
<li><a href="section05.03.html">3. The second derivative test</a></li>
<li><a href="section05.04.html">4. Concavity and inflection points</a></li>
<li><a href="section05.05.html">5. Asymptotes and Other Things to Look For</a></li>
</ul>

<h2 class="link"><img id="chapter_06_button" src="expand_submenu.png" onclick='toggle("chapter_06_contents")'><a href="chapter06.html">6 Applications of the Derivative</a></h2>

<ul class="list" id="chapter_06_contents">
<li><a href="section06.01.html">1. Optimization</a></li>
<li><a href="section06.02.html">2. Related Rates</a></li>
<li><a href="section06.03.html">3. Newton's Method</a></li>
<li><a href="section06.04.html">4. Linear Approximations</a></li>
<li><a href="section06.05.html">5. The Mean Value Theorem</a></li>
</ul>

<h2 class="link"><img id="chapter_07_button" src="expand_submenu.png" onclick='toggle("chapter_07_contents")'><a href="chapter07.html">7 Integration</a></h2>

<ul class="list" id="chapter_07_contents">
<li><a href="section07.01.html">1. Two examples</a></li>
<li><a href="section07.02.html">2. The Fundamental Theorem of Calculus</a></li>
<li><a href="section07.03.html">3. Some Properties of Integrals</a></li>
</ul>

<h2 class="link"><img id="chapter_08_button" src="expand_submenu.png" onclick='toggle("chapter_08_contents")'><a href="chapter08.html">8 Techniques of Integration</a></h2>

<ul class="list" id="chapter_08_contents">
<li><a href="section08.01.html">1. Substitution</a></li>
<li><a href="section08.02.html">2. Powers of sine and cosine</a></li>
<li><a href="section08.03.html">3. Trigonometric Substitutions</a></li>
<li><a href="section08.04.html">4. Integration by Parts</a></li>
<li><a href="section08.05.html">5. Rational Functions</a></li>
<li><a href="section08.06.html">6. Numerical Integration</a></li>
<li><a href="section08.07.html">7. Additional exercises</a></li>
</ul>

<h2 class="link"><img id="chapter_09_button" src="expand_submenu.png" onclick='toggle("chapter_09_contents")'><a href="chapter09.html">9 Applications of Integration</a></h2>

<ul class="list" id="chapter_09_contents">
<li><a href="section09.01.html">1. Area between curves</a></li>
<li><a href="section09.02.html">2. Distance, Velocity, Acceleration</a></li>
<li><a href="section09.03.html">3. Volume</a></li>
<li><a href="section09.04.html">4. Average value of a function</a></li>
<li><a href="section09.05.html">5. Work</a></li>
<li><a href="section09.06.html">6. Center of Mass</a></li>
<li><a href="section09.07.html">7. Kinetic energy; improper integrals</a></li>
<li><a href="section09.08.html">8. Probability</a></li>
<li><a href="section09.09.html">9. Arc Length</a></li>
<li><a href="section09.10.html">10. Surface Area</a></li>
</ul>

<h2 class="link"><img id="chapter_10_button" src="expand_submenu.png" onclick='toggle("chapter_10_contents")'><a href="chapter10.html">10 Polar Coordinates,  Parametric Equations</a></h2>

<ul class="list" id="chapter_10_contents">
<li><a href="section10.01.html">1. Polar Coordinates</a></li>
<li><a href="section10.02.html">2. Slopes in polar coordinates</a></li>
<li><a href="section10.03.html">3. Areas in polar coordinates</a></li>
<li><a href="section10.04.html">4. Parametric Equations</a></li>
<li><a href="section10.05.html">5. Calculus with Parametric Equations</a></li>
</ul>

<h2 class="link"><img id="chapter_11_button" src="expand_submenu.png" onclick='toggle("chapter_11_contents")'><a href="chapter11.html">11 Sequences and Series</a></h2>

<ul class="list" id="chapter_11_contents">
<li><a href="section11.01.html">1. Sequences</a></li>
<li><a href="section11.02.html">2. Series</a></li>
<li><a href="section11.03.html">3. The Integral Test</a></li>
<li><a href="section11.04.html">4. Alternating Series</a></li>
<li><a href="section11.05.html">5. Comparison Tests</a></li>
<li><a href="section11.06.html">6. Absolute Convergence</a></li>
<li><a href="section11.07.html">7. The Ratio and Root Tests</a></li>
<li><a href="section11.08.html">8. Power Series</a></li>
<li><a href="section11.09.html">9. Calculus with Power Series</a></li>
<li><a href="section11.10.html">10. Taylor Series</a></li>
<li><a href="section11.11.html">11. Taylor's Theorem</a></li>
<li><a href="section11.12.html">12. Additional exercises</a></li>
</ul>

<h2 class="link"><img id="chapter_12_button" src="expand_submenu.png" onclick='toggle("chapter_12_contents")'><a href="chapter12.html">12 Three Dimensions</a></h2>

<ul class="list" id="chapter_12_contents">
<li><a href="section12.01.html">1. The Coordinate System</a></li>
<li><a href="section12.02.html">2. Vectors</a></li>
<li><a href="section12.03.html">3. The Dot Product</a></li>
<li><a href="section12.04.html">4. The Cross Product</a></li>
<li><a href="section12.05.html">5. Lines and Planes</a></li>
<li><a href="section12.06.html">6. Other Coordinate Systems</a></li>
</ul>

<h2 class="link"><img id="chapter_13_button" src="expand_submenu.png" onclick='toggle("chapter_13_contents")'><a href="chapter13.html">13 Vector Functions</a></h2>

<ul class="list" id="chapter_13_contents">
<li><a href="section13.01.html">1. Space Curves</a></li>
<li><a href="section13.02.html">2. Calculus with vector functions</a></li>
<li><a href="section13.03.html">3. Arc length and curvature</a></li>
<li><a href="section13.04.html">4. Motion along a curve</a></li>
</ul>

<h2 class="link"><img id="chapter_14_button" src="expand_submenu.png" onclick='toggle("chapter_14_contents")'><a href="chapter14.html">14 Partial Differentiation</a></h2>

<ul class="list" id="chapter_14_contents">
<li><a href="section14.01.html">1. Functions of Several Variables</a></li>
<li><a href="section14.02.html">2. Limits and Continuity</a></li>
<li><a href="section14.03.html">3. Partial Differentiation</a></li>
<li><a href="section14.04.html">4. The Chain Rule</a></li>
<li><a href="section14.05.html">5. Directional Derivatives</a></li>
<li><a href="section14.06.html">6. Higher order derivatives</a></li>
<li><a href="section14.07.html">7. Maxima and minima</a></li>
<li><a href="section14.08.html">8. Lagrange Multipliers</a></li>
</ul>

<h2 class="link"><img id="chapter_15_button" src="expand_submenu.png" onclick='toggle("chapter_15_contents")'><a href="chapter15.html">15 Multiple Integration</a></h2>

<ul class="list" id="chapter_15_contents">
<li><a href="section15.01.html">1. Volume and Average Height</a></li>
<li><a href="section15.02.html">2. Double Integrals in Cylindrical Coordinates</a></li>
<li><a href="section15.03.html">3. Moment and Center of Mass</a></li>
<li><a href="section15.04.html">4. Surface Area</a></li>
<li><a href="section15.05.html">5. Triple Integrals</a></li>
<li><a href="section15.06.html">6. Cylindrical and Spherical Coordinates</a></li>
<li><a href="section15.07.html">7. Change of Variables</a></li>
</ul>

<h2 class="link"><img id="chapter_16_button" src="expand_submenu.png" onclick='toggle("chapter_16_contents")'><a href="chapter16.html">16 Vector Calculus</a></h2>

<ul class="list" id="chapter_16_contents">
<li><a href="section16.01.html">1. Vector Fields</a></li>
<li><a href="section16.02.html">2. Line Integrals</a></li>
<li><a href="section16.03.html">3. The Fundamental Theorem of Line Integrals</a></li>
<li><a href="section16.04.html">4. Green's Theorem</a></li>
<li><a href="section16.05.html">5. Divergence and Curl</a></li>
<li><a href="section16.06.html">6. Vector Functions for Surfaces</a></li>
<li><a href="section16.07.html">7. Surface Integrals</a></li>
<li><a href="section16.08.html">8. Stokes's Theorem</a></li>
<li><a href="section16.09.html">9. The Divergence Theorem</a></li>
</ul>

<h2 class="link"><img id="chapter_17_button" src="expand_submenu.png" onclick='toggle("chapter_17_contents")'><a href="chapter17.html">17 Differential Equations</a></h2>

<ul class="list" id="chapter_17_contents">
<li><a href="section17.01.html">1. First Order Differential Equations</a></li>
<li><a href="section17.02.html">2. First Order Homogeneous Linear Equations</a></li>
<li><a href="section17.03.html">3. First Order Linear Equations</a></li>
<li><a href="section17.04.html">4. Approximation</a></li>
<li><a href="section17.05.html">5. Second Order Homogeneous Equations</a></li>
<li><a href="section17.06.html">6. Second Order Linear Equations</a></li>
<li><a href="section17.07.html">7. Second Order Linear Equations, take two</a></li>
</ul>

<h2 class="link"><img id="chapter_18_button" src="expand_submenu.png" onclick='toggle("chapter_18_contents")'><a href="chapter18.html">18 Useful formulas</a></h2>

<ul class="list" id="chapter_18_contents">
</ul>

</div>

<div id="main">

<div id="next"><a href="section08.03.html"><img src=previous_section.png width="30"></a>&nbsp;&nbsp;<a href="section08.05.html"><img src=next_section.png width="30"></a></div>

<div id="content">
<p>


</p><p>
We have already seen that recognizing the product rule can be useful,
when we noticed that
$$\int \sec^3u+\sec u \tan^2u\,du=\sec u \tan u.$$
As with substitution, we do not have to rely on insight or cleverness
to discover such antiderivatives; there is a technique that will often
help to uncover the product rule.
</p><p>
Start with the product rule:
$${d\over dx}f(x)g(x)=f'(x)g(x)+f(x)g'(x).$$
We can rewrite this as
$$f(x)g(x)=\int f'(x)g(x)\,dx +\int f(x)g'(x)\,dx,$$
and then
$$\int f(x)g'(x)\,dx=f(x)g(x)-\int f'(x)g(x)\,dx.$$
This may not seem particularly useful at first glance, but it turns
out that in many cases we have an integral of the form
$$\int f(x)g'(x)\,dx$$
but that 
$$\int f'(x)g(x)\,dx$$
is easier. This technique for turning one integral into another is
called <b>integration by parts</b>,
and is usually written in more compact form. If we let $u=f(x)$ and
$v=g(x)$ then $du=f'(x)\,dx$ and $dv=g'(x)\,dx$ and 
$$\int u\,dv = uv-\int v\,du.$$
To use this technique we need to identify likely candidates for
$u=f(x)$ and $dv=g'(x)\,dx$.
</p><p>
</p>
<div class="example">
<p>
<span class="theoremlabel">Example 8.4.1 </span>
Evaluate $\ds\int x\ln x\,dx$. Let $u=\ln x$ so $du=1/x\,dx$. Then
we must let $dv=x\,dx$ so $\ds v=x^2/2$ and
$$
 \int x\ln x\,dx={x^2\ln x\over 2}-\int {x^2\over2}{1\over x}\,dx=
 {x^2\ln x\over 2}-\int {x\over2}\,dx={x^2\ln x\over 2}-{x^2\over4}+C.
$$
</p><p>

</p>
</div><!-- example -->
<p>
</p><p>
</p>
<div class="example">
<p>
<span class="theoremlabel">Example 8.4.2 </span>
Evaluate $\ds\int x\sin x\,dx$. Let $u=x$ so $du=dx$. Then
we must let $dv=\sin x\,dx$ so $v=-\cos x$ and
$$\int x\sin x\,dx=-x\cos x-\int -\cos x\,dx=
-x\cos x+\int \cos x\,dx=-x\cos x+\sin x+C.$$
</p><p>

</p>
</div><!-- example -->
<p>
</p><p>
</p>
<div class="example">
<p>
<span class="theoremlabel">Example 8.4.3 </span>
Evaluate $\ds\int\sec^3 x\,dx$. Of course we already know the answer
to this, but we needed to be clever to discover it. Here we'll use the
new technique to discover the antiderivative.
Let $u=\sec x$ and $\ds dv=\sec^2 x\,dx$. Then $du=\sec x\tan x\,dx$ and
$v=\tan x$ and
$$\eqalign{
  \int\sec^3 x\,dx&=\sec x\tan x-\int \tan^2x\sec x\,dx\cr
  &=\sec x\tan x-\int (\sec^2x-1)\sec x\,dx\cr
  &=\sec x\tan x-\int \sec^3x\,dx +\int\sec x\,dx.\cr
}$$
At first this looks useless&mdash;we're right back to
$\ds \int\sec^3x\,dx$. But looking more closely:
$$\eqalign{
  \int\sec^3x\,dx&=\sec x\tan x-\int \sec^3x\,dx +\int\sec x\,dx\cr
  \int\sec^3x\,dx+\int \sec^3x\,dx&=\sec x\tan x +\int\sec x\,dx\cr
  2\int\sec^3x\,dx&=\sec x\tan x +\int\sec x\,dx\cr
  \int\sec^3x\,dx&={\sec x\tan x\over2} +{1\over2}\int\sec x\,dx\cr
  &={\sec x\tan x\over2} +{\ln|\sec x+\tan x|\over2}+C.\cr
}$$
</p><p>

</p>
</div><!-- example -->
<p>
</p><p>
</p>
<div class="example">
<p>
<span class="theoremlabel">Example 8.4.4 </span>
Evaluate $\ds\int x^2\sin x\,dx$. 
Let $u=x^2$, $dv=\sin x\,dx$; then $du=2x\,dx$ and $v=-\cos x$. 
Now $\ds \int x^2\sin x\,dx=-x^2\cos x+\int 2x\cos x\,dx$. This is
better than the original integral, but we need to do integration by
parts again. Let $u=2x$, $dv=\cos x\,dx$; then
$du=2$ and $v=\sin x$, and
$$\eqalign{
  \int x^2\sin x\,dx&=-x^2\cos x+\int 2x\cos x\,dx\cr
  &=-x^2\cos x+ 2x\sin x - \int 2\sin x\,dx\cr
  &=-x^2\cos x+ 2x\sin x + 2\cos x + C.\cr
}$$
</p><p>

</p>
</div><!-- example -->
<p>
</p><p>
Such repeated use of integration by parts is fairly common, but it can
be a bit tedious to accomplish, and it is easy to make
errors, especially sign errors involving the subtraction in the
formula. There is a nice tabular method to accomplish the calculation
that minimizes the chance for error and speeds up the whole
process. We illustrate with the previous example. Here is the
table:
</p><p>
</p><p><div class='figure'><!-- Integration_techniques-parts_by_table.html -->
<!-- Table in 8.4 -->
<table style="margin-left:auto;margin-right:auto;">
<tr><td>
<table style="margin-left:auto;margin-right:auto;border-width:2px;border-style:outset;border-color:gray;">
<tr>
<td style="padding:2px 15px 2px 15px;text-align:center;border-width:1px;border-style:outset;border-color:gray;">
sign</td>
<td style="padding:2px 15px 2px 15px;text-align:center;border-width:1px;border-style:outset;border-color:gray">
$u$</td>
<td style="padding:2px 15px 2px 15px;text-align:center;border-width:1px;border-style:outset;border-color:gray">
$dv$</td>
</tr>
<tr>
<td style="padding:2px 15px 2px 15px;text-align:center;border-width:1px;border-style:outset;border-color:gray;">
&nbsp;</td>
<td style="padding:2px 15px 2px 15px;text-align:center;border-width:1px;border-style:outset;border-color:gray">
$x^2$</td>
<td style="padding:2px 15px 2px 15px;text-align:right;border-width:1px;border-style:outset;border-color:gray">
$\sin x$</td>
</tr>
<tr>
<td style="padding:2px 15px 2px 15px;text-align:center;border-width:1px;border-style:outset;border-color:gray;">
$-$</td>
<td style="padding:2px 15px 2px 15px;text-align:center;border-width:1px;border-style:outset;border-color:gray">
$2x$</td>
<td style="padding:2px 15px 2px 15px;text-align:right;border-width:1px;border-style:outset;border-color:gray">
$-\cos x$</td>
</tr>
<tr>
<td style="padding:2px 15px 2px 15px;text-align:center;border-width:1px;border-style:outset;border-color:gray;">
&nbsp;</td>
<td style="padding:2px 15px 2px 15px;text-align:center;border-width:1px;border-style:outset;border-color:gray">
$2$</td>
<td style="padding:2px 15px 2px 15px;text-align:right;border-width:1px;border-style:outset;border-color:gray">
$-\sin x$</td>
</tr>
<tr>
<td style="padding:2px 15px 2px 15px;text-align:center;border-width:1px;border-style:outset;border-color:gray;">
$-$</td>
<td style="padding:2px 15px 2px 15px;text-align:center;border-width:1px;border-style:outset;border-color:gray">
$0$</td>
<td style="padding:2px 15px 2px 15px;text-align:right;border-width:1px;border-style:outset;border-color:gray">
$\cos x$</td>
</tr>
</table>
</td><td style="padding: 2px 15px;">
or
</td><td>
<table style="margin-left:auto;margin-right:auto;border-width:2px;border-style:outset;border-color:gray;">
<tr>
<td style="padding:2px 15px 2px 15px;text-align:center;border-width:1px;border-style:outset;border-color:gray">
$u$</td>
<td style="padding:2px 15px 2px 15px;text-align:center;border-width:1px;border-style:outset;border-color:gray">
$dv$</td>
</tr>
<tr>
<td style="padding:2px 15px 2px 15px;text-align:center;border-width:1px;border-style:outset;border-color:gray">
$x^2$</td>
<td style="padding:2px 15px 2px 15px;text-align:right;border-width:1px;border-style:outset;border-color:gray">
$\sin x$</td>
</tr>
<tr>
<td style="padding:2px 15px 2px 15px;text-align:center;border-width:1px;border-style:outset;border-color:gray">
$-2x$</td>
<td style="padding:2px 15px 2px 15px;text-align:right;border-width:1px;border-style:outset;border-color:gray">
$-\cos x$</td>
</tr>
<tr>
<td style="padding:2px 15px 2px 15px;text-align:center;border-width:1px;border-style:outset;border-color:gray">
$2$</td>
<td style="padding:2px 15px 2px 15px;text-align:right;border-width:1px;border-style:outset;border-color:gray">
$-\sin x$</td>
</tr>
<tr>
<td style="padding:2px 15px 2px 15px;text-align:center;border-width:1px;border-style:outset;border-color:gray">
$0$</td>
<td style="padding:2px 15px 2px 15px;text-align:right;border-width:1px;border-style:outset;border-color:gray">
$\cos x$</td>
</tr>
</table>
</td></tr></table>

</div></p><p></p><p>
To form the first table, we start with $u$ at the top of the second
column and repeatedly compute the derivative; starting with $dv$ at
the top of the third column, we repeatedly compute the
antiderivative. In the first column, we place a "$-$'' in every
second row. To form the 
second table we combine the first and second columns by
ignoring the boundary; if you do this by hand, you may simply start
with two columns and add a "$-$'' to every second row.
</p><p>
To compute with this second table we begin at the top. Multiply the
first entry in column $u$ by the second entry in column $dv$ to get
$\ds -x^2\cos x$, and add this to the integral of the product of the
second entry in column $u$ and second entry in column $dv$.  This
gives:
$$-x^2\cos x+\int 2x\cos x\,dx,$$
or exactly the result of the first application of integration by
parts.  Since this integral is not yet easy, we return to the table.
Now we multiply twice on the diagonal, $\ds (x^2)(-\cos x)$ and
$(-2x)(-\sin x)$ and then once straight across, $(2)(-\sin x)$, and
combine these as
$$-x^2\cos x+2x\sin x-\int 2\sin x\,dx,$$
giving the same result as the second application of integration by
parts. While this integral is easy, we may return yet once more to the
table. Now multiply three times on the diagonal to get $\ds
(x^2)(-\cos x)$, $(-2x)(-\sin x)$, and $(2)(\cos x)$, and once
straight across, $(0)(\cos x)$. We combine these as before to get
$$
  -x^2\cos x+2x\sin x +2\cos x+\int 0\,dx=
  -x^2\cos x+2x\sin x +2\cos x+C.
$$
Typically we would fill in the table one line at a time, until the
"straight across'' multiplication gives an easy integral. If we can
see that the $u$ column will eventually become zero, we can instead
fill in the whole table; computing the products as indicated will then
give the entire integral, including the "$+C\,$'', as above.
</p><p>
</p>
<a id="exercises"></a><h2 class="exercises">Exercises 8.4</h2>
<p></p><p>
Find the antiderivatives.
</p><p>

</p><p>
</p>
<p class="exercise"><b>Ex 8.4.1</b>
$\ds\int x\cos x\,dx$
(<a knowl="" class="internal" value="$\cos x+x\sin x+C$">answer</a>)


</p><p>
</p>
<p class="exercise"><b>Ex 8.4.2</b>
$\ds\int x^2\cos x\,dx$
(<a knowl="" class="internal" value="$\ds x^2\sin x-2 \sin x+2x\cos x +C$">answer</a>)


</p><p>
</p>
<p class="exercise"><b>Ex 8.4.3</b>
$\ds\int xe^x\,dx$
(<a knowl="" class="internal" value="$\ds (x-1)e^x +C$">answer</a>)


</p><p>
</p>
<p class="exercise"><b>Ex 8.4.4</b>
$\ds\int xe^{x^2}\,dx$
(<a knowl="" class="internal" value="$\ds (1/2)e^{x^2} +C$">answer</a>)


</p><p>
</p>
<p class="exercise"><b>Ex 8.4.5</b>
$\ds\int \sin^2 x\,dx$
(<a knowl="" class="internal" value="$(x/2)-\sin(2x)/4 +C=$$(x/2)-(\sin x\cos x)/2+C$">answer</a>)


</p><p>
</p>
<p class="exercise"><b>Ex 8.4.6</b>
$\ds\int \ln x\,dx$
(<a knowl="" class="internal" value="$x\ln x-x +C$">answer</a>)


</p><p>
</p>
<p class="exercise"><b>Ex 8.4.7</b>
$\ds\int x\arctan x\,dx$
(<a knowl="" class="internal" value="$\ds (x^2\arctan x +\arctan x -x)/2+C$">answer</a>)


</p><p>
</p>
<p class="exercise"><b>Ex 8.4.8</b>
$\ds\int x^3\sin x\,dx$
(<a knowl="" class="internal" value="$\ds -x^3\cos x+3x^2\sin x+6x\cos x-6\sin x+C$">answer</a>)


</p><p>
</p>
<p class="exercise"><b>Ex 8.4.9</b>
$\ds\int x^3\cos x\,dx$
(<a knowl="" class="internal" value="$\ds x^3\sin x+3x^2\cos x-6x\sin x-6\cos x+C$">answer</a>)


</p><p>
</p>
<p class="exercise"><b>Ex 8.4.10</b>
$\ds\int x\sin^2 x\,dx$
(<a knowl="" class="internal" value="$\ds x^2/4-(\cos^2 x)/4-(x\sin x\cos x)/2+C$">answer</a>)


</p><p>
</p>
<p class="exercise"><b>Ex 8.4.11</b>
$\ds\int x\sin x\cos x\,dx$
(<a knowl="" class="internal" value="$\ds x/4-(x\cos^2 x)/2+(\cos x\sin x)/4+C$">answer</a>)


</p><p>
</p>
<p class="exercise"><b>Ex 8.4.12</b>
$\ds\int \arctan(\sqrt x)\,dx$
(<a knowl="" class="internal" value="$x\arctan(\sqrt x)+\arctan(\sqrt x)-\sqrt{x}+C$">answer</a>)


</p><p>
</p>
<p class="exercise"><b>Ex 8.4.13</b>
$\ds\int \sin(\sqrt x)\,dx$
(<a knowl="" class="internal" value="$2\sin(\sqrt x)-2\sqrt x\cos(\sqrt x)+C$">answer</a>)


</p><p>
</p>
<p class="exercise"><b>Ex 8.4.14</b>
$\ds\int\sec^2 x\csc^2 x\,dx$
(<a knowl="" class="internal" value="$\sec x\csc x-2\cot x+C$">answer</a>)

</p><p>


</p><p>


</div></div></body>
</html>
